









    
    
    
    



    










<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Sml Python Small Library Reference - Office for National Statistics</title>
        <link rel="stylesheet" href="https://cdn.ons.gov.uk/sdc/design-system/62.0.0/css/main.css">
        <link rel="stylesheet" media="print" href="https://cdn.ons.gov.uk/sdc/design-system/62.0.0/css/print.css">
        <meta name="theme-color" content="#206095"/>
        
            
                
                    <meta name="description" content="/">
                

                <!-- Canonical -->
                <link rel="canonical" href="/">

                
            
        

        
            <!-- Open Graph -->
            <meta property="og:type" content="website">
            <meta property="og:url" content="/">
            <meta property="og:title" content="Sml Python Small Library Reference - Office for National Statistics">
            <meta property="og:image" content="https://cdn.ons.gov.uk/sdc/design-system/62.0.0/favicons/opengraph.png">
            <meta property="og:image:type" content="image/png">
            <meta property="og:image:width" content="1200">
            <meta property="og:image:height" content="630">
            <meta property="og:description" content="/">
            <meta property="og:site_name" content="Sml Python Small Library Reference">
            <meta property="og:locale" content="en">

            

            
        

        
            <!-- Favicons -->
            <link rel="icon" type="image/x-icon" href="https://cdn.ons.gov.uk/sdc/design-system/62.0.0/favicons/favicon.ico">
            <link rel="icon" type="image/png" href="https://cdn.ons.gov.uk/sdc/design-system/62.0.0/favicons/favicon-32x32.png" sizes="32x32">
            <link rel="icon" type="image/png" href="https://cdn.ons.gov.uk/sdc/design-system/62.0.0/favicons/favicon-16x16.png" sizes="16x16">
            <link rel="mask-icon" href="https://cdn.ons.gov.uk/sdc/design-system/62.0.0/favicons/safari-pinned-tab.svg" color="#000000">
            <link rel="apple-touch-icon" type="image/png" href="https://cdn.ons.gov.uk/sdc/design-system/62.0.0/favicons/apple-touch-icon.png" sizes="180x180">
            <link rel="manifest" href="https://cdn.ons.gov.uk/sdc/design-system/62.0.0/favicons/manifest.json">
        

        

    </head>
    <body>
        <script>document.body.className = ((document.body.className) ? document.body.className + ' ons-js-enabled' : 'ons-js-enabled');</script>
        
        
            <div class="ons-page">
                <div class="ons-page__content">
                    
                    
                    
                        
    <a class="ons-skip-link" href="#main-content">Skip to main content</a>

                    
                    
                        
    
    
    
    

    
    

    

    <header class="ons-header " role="banner">
        
    
        
        
        
    

    <div class="ons-browser-banner">
        <div class="ons-container">
            <p class="ons-browser-banner__content"><span class="ons-browser-banner__lead">This website no longer supports your browser.</span><span class="ons-browser-banner__cta"> You can <a class="ons-browser-banner__link" href="https://www.ons.gov.uk/help/browsers">upgrade your browser to the latest version</a>.</span></p>
        </div>
    </div>

        
        <div class="ons-header__top">
            <div class="ons-container">
                <div class="ons-header__grid-top ons-grid ons-grid--gutterless ons-grid--flex ons-grid--between ons-grid--vertical-center ons-grid--no-wrap">
                    <div class="ons-grid__col ons-col-auto"><div class="ons-header__org-logo ons-header__org-logo--large">
                            
                                

    

    
    
        <svg class="ons-svg-logo" xmlns="http://www.w3.org/2000/svg" width="197" height="19" viewBox="33 2 552 60" aria-labelledby="ons-logo-en-alt">
            <title id="ons-logo-en-alt">Office for National Statistics logo</title>
            <g class="ons-svg-logo__group ons-svg-logo__group--secondary" fill="#a8bd3a">
                <path d="M0,34.6c.8-1.69,1.39-3,2.32-4.6A38.28,38.28,0,0,1,0,23.4V34.6M5,3S0,3,0,9.25v1A62.12,62.12,0,0,0,4.2,27a43.77,43.77,0,0,1,9.42-10.79C21.69,9.21,31.16,5.13,45.9,3Z"/>
            </g>
            <g class="ons-svg-logo__group ons-svg-logo__group--primary" fill="#003c57">
                <path d="M53.06,6.42C36.2,8,24.68,12.92,16.43,20.07A41.46,41.46,0,0,0,6.4,32.2C12.87,44.93,28.88,57,46.6,57H47s6.32.21,6.32-6.91V6.36a1.22,1.22,0,0,1-.26.06M9.72,42.67a44.25,44.25,0,0,1-5-7.42A80.59,80.59,0,0,0,0,46.38V56.91L31.06,57c-9.83-3-15.74-7.64-21.34-14.3"/>
            </g>
            <g class="ons-svg-logo__group ons-svg-logo__group--text" fill="#003c57">
                <path d="M82,47.49c-9.07,0-13.13-7.51-13.13-16.77S72.91,14,82,14s13.1,7.61,13.1,16.77S91.1,47.54,82,47.54m0-30.91c-6.69,0-9.07,7.33-9.07,14.05s2.16,13.9,9.07,13.9,9-7.28,9-13.9-2.34-14-9-14"/>
                <path d="M106.36,23.81V46.88h-3.67V23.81H98.93V21.56h3.76V17.9c0-4.61,2.72-7.95,8.08-7.95.38,0,.86.05.86.05v2.35h-.43c-2.55,0-4.84,1.64-4.84,5.12v4.09h5.27v2.25Z"/>
                <path d="M121.53,23.81V46.88h-3.67V23.81H114.1V21.56h3.76V17.9c0-4.61,2.72-7.95,8.08-7.95.38,0,.86.05.86.05v2.35h-.43c-2.55,0-4.84,1.64-4.84,5.12v4.09h5.27v2.25Z"/>
                <path d="M132.85,16.72a2.28,2.28,0,0,1-2.33-2.23v0a2.34,2.34,0,0,1,4.67,0,2.28,2.28,0,0,1-2.3,2.26h0M131,21.56h3.71V46.88H131Z"/>
                <path d="M150.53,47.49c-6,0-10.63-5.16-10.63-13.29S144.52,21,150.66,21a9.76,9.76,0,0,1,6.17,1.74l-1,2.25a7.53,7.53,0,0,0-4.4-1.36c-5.15,0-7.78,4.46-7.78,10.48,0,6.2,3,10.62,7.65,10.62a8,8,0,0,0,4.49-1.37l1,2.45a10.21,10.21,0,0,1-6.3,1.73"/>
                <path d="M162.84,35.75c.48,6,3.76,9,8.9,9a14.66,14.66,0,0,0,6.88-1.55l1.08,2.59a18,18,0,0,1-8.22,1.73c-7.12,0-12.18-4.23-12.18-13.34,0-8.69,4.67-13.2,11-13.2s10.37,3.95,10.37,12.4Zm7.35-12.41c-4.1,0-7.56,3.2-7.52,10.29l14.39-2c0-5.87-2.81-8.32-6.87-8.32"/>
                <path d="M198.57,23.81V46.88H194.9V23.81h-3.76V21.56h3.76V17.9c0-4.61,2.72-7.95,8.08-7.95.39,0,.87.05.87.05v2.35h-.44c-2.54,0-4.84,1.64-4.84,5.12v4.09h5.28v2.25Z"/>
                <path d="M217.28,47.49c-7.47,0-10.89-5.78-10.89-13.24S209.81,21,217.28,21s10.85,5.82,10.85,13.3-3.37,13.24-10.85,13.24m0-24c-5.53,0-7.13,5.59-7.13,10.81s1.73,10.56,7.13,10.56,7.13-5.35,7.13-10.56-1.6-10.81-7.13-10.81"/>
                <path d="M244.08,23.91c-2.34-.61-5.75-.52-7.35.47v22.5H233V22.69c2.67-1.13,5.36-1.74,10.11-1.74H245Z"/>
                <path d="M277.42,47.13,263.07,25a32.2,32.2,0,0,1-1.85-3.29h-.09s.13,1.88.13,3.85V47.13h-4.71V14.8h5.31l13.61,20.82A28.76,28.76,0,0,1,277.38,39h.08s-.17-1.84-.17-3.77V14.8H282V47.13Z"/>
                <path d="M297.52,47.79c-7.43,0-10.93-3-10.93-7.81,0-6.8,7.12-8.64,15.59-9.39V29.13c0-3.47-2.37-4.51-5.83-4.51a18,18,0,0,0-6.87,1.46L288.23,23a24,24,0,0,1,9.12-1.83c5.61,0,9.93,2.3,9.93,8.78V46a22.71,22.71,0,0,1-9.76,1.83m4.66-14.67c-6.26.67-10.45,1.84-10.45,6.73,0,3.42,2.42,4.88,6.22,4.88a10.09,10.09,0,0,0,4.23-.84Z"/>
                <path d="M322,47.69c-5.31,0-7.34-3.43-7.34-6.86V25.09h-3.55V21.81h3.55V16.12l5.4-1.5v7.19H325v3.28h-5V40.55a3.26,3.26,0,0,0,3,3.52h.5a5.5,5.5,0,0,0,1.46-.23v3.33a7.69,7.69,0,0,1-3,.52"/>
                <path d="M331.91,17.43a3,3,0,0,1-3.15-2.81,3.17,3.17,0,0,1,6.31,0,3,3,0,0,1-3.16,2.81m-2.72,4.38h5.44V47.13h-5.44Z"/>
                <path d="M350.88,47.79c-7.73,0-11.57-5.74-11.57-13.3s3.84-13.34,11.57-13.34,11.54,5.78,11.54,13.34-3.8,13.3-11.54,13.3m0-23.17c-4.66,0-6.05,4.89-6.05,9.82s1.47,9.63,6.05,9.63,6.05-4.7,6.05-9.63-1.38-9.82-6.05-9.82"/>
                <path d="M382.52,47.13V29c0-3.24-2.77-4.47-5.88-4.47a12.3,12.3,0,0,0-4.37.76v21.8h-5.39V23a26.81,26.81,0,0,1,10.06-1.83c6.61,0,11,2.25,11,7.8V47.13Z"/>
                <path d="M403.18,47.79c-7.43,0-10.94-3-10.94-7.81,0-6.8,7.13-8.64,15.6-9.39V29.13c0-3.47-2.37-4.51-5.83-4.51a18,18,0,0,0-6.87,1.46L393.89,23A24,24,0,0,1,403,21.15c5.62,0,9.94,2.3,9.94,8.78V46a22.71,22.71,0,0,1-9.76,1.83m4.66-14.67c-6.27.67-10.46,1.84-10.46,6.73,0,3.42,2.43,4.88,6.23,4.88a10.09,10.09,0,0,0,4.23-.84Z"/>
                <polygon points="418.52 47.13 418.52 34.91 418.52 10.25 423.92 10.25 423.92 22.76 423.92 47.13 418.52 47.13"/>
                <path d="M445.39,47.79A19.11,19.11,0,0,1,436.58,46l1.51-4a13.48,13.48,0,0,0,6.22,1.55c3.76,0,6.44-2.21,6.44-5.41,0-7.09-13.44-4.36-13.44-14.42,0-5.13,4.15-9.59,10.72-9.59A15.82,15.82,0,0,1,455.8,16l-1.38,3.52a11.93,11.93,0,0,0-5.66-1.5c-3.5,0-5.79,2.11-5.79,5.12,0,7,13.74,3.94,13.74,14.65,0,5.74-4.71,10-11.32,10"/>
                <path d="M470.41,47.69c-5.31,0-7.34-3.43-7.34-6.86V25.09h-3.54V21.81h3.54V16.12l5.4-1.5v7.19h4.92v3.28h-4.92V40.55a3.27,3.27,0,0,0,3,3.52h.48a5.12,5.12,0,0,0,1.46-.23v3.33a7.69,7.69,0,0,1-3,.52"/>
                <path d="M487.27,47.79c-7.44,0-10.93-3-10.93-7.81,0-6.8,7.13-8.64,15.6-9.39V29.13c0-3.47-2.38-4.51-5.84-4.51a18,18,0,0,0-6.87,1.46L478,23a23.94,23.94,0,0,1,9.11-1.83c5.62,0,9.94,2.3,9.94,8.78V46a22.71,22.71,0,0,1-9.76,1.83M492,33.16c-6.27.67-10.46,1.84-10.46,6.73,0,3.42,2.42,4.88,6.22,4.88a10,10,0,0,0,4.24-.84Z"/>
                <path d="M511.73,47.69c-5.32,0-7.35-3.43-7.35-6.86V25.09h-3.54V21.81h3.54V16.12l5.4-1.5v7.19h4.92v3.28h-4.92V40.55a3.26,3.26,0,0,0,3,3.52h.5a5.5,5.5,0,0,0,1.46-.23v3.33a7.69,7.69,0,0,1-3,.52"/>
                <path d="M521.66,17.43a3,3,0,0,1-3.15-2.81,3.17,3.17,0,0,1,6.31,0,3,3,0,0,1-3.16,2.81m-2.72,4.38h5.45V47.13h-5.45Z"/>
                <path d="M536.19,47.79A15.9,15.9,0,0,1,528.54,46L530,42.48a10.53,10.53,0,0,0,5.52,1.5c2.77,0,5-1.78,5-3.94,0-6-11.1-3.2-11.1-11.47,0-3.76,3.37-7.42,8.86-7.42A13.56,13.56,0,0,1,545.34,23l-1.42,3.14a8.47,8.47,0,0,0-4.62-1.45c-2.81,0-4.54,1.69-4.54,3.62,0,5.64,11.32,3.14,11.32,11.6,0,4-3.85,7.9-9.89,7.9"/>
                <path d="M559.83,47.69c-5.31,0-7.35-3.43-7.35-6.86V25.09h-3.54V21.81h3.54V16.12l5.4-1.5v7.19h4.93v3.28h-4.93V40.55a3.27,3.27,0,0,0,3,3.52h.48a5.64,5.64,0,0,0,1.47-.23v3.33a7.72,7.72,0,0,1-3,.52"/>
                <path d="M569.77,17.43a3,3,0,0,1-3.15-2.81,3.17,3.17,0,0,1,6.31,0,3,3,0,0,1-3.16,2.81m-2.72,4.38h5.44V47.13h-5.44Z"/>
                <path d="M588.14,47.79c-6.23,0-11-5.08-11-13.35s4.88-13.29,11-13.29A10.51,10.51,0,0,1,594.66,23l-1.21,3a6.87,6.87,0,0,0-4-1.22c-4.4,0-6.69,3.81-6.69,9.49s2.63,9.59,6.61,9.59a6.74,6.74,0,0,0,4-1.28L594.7,46c-1.12.94-3.33,1.84-6.56,1.84"/>
                <path d="M605.1,47.79A15.9,15.9,0,0,1,597.45,46l1.42-3.47A10.54,10.54,0,0,0,604.4,44c2.77,0,5-1.78,5-3.94,0-6-11.1-3.2-11.1-11.47,0-3.76,3.37-7.42,8.85-7.42a13.49,13.49,0,0,1,7.1,1.83l-1.42,3.14a8.42,8.42,0,0,0-4.63-1.45c-2.8,0-4.53,1.69-4.53,3.62,0,5.64,11.32,3.14,11.32,11.6,0,4-3.85,7.9-9.89,7.9"/>
            </g>
        </svg>
    

                            
                        </div>
                        <div class="ons-header__org-logo ons-header__org-logo--small">
                            
                                

    

    
    
        <svg class="ons-svg-logo" xmlns="http://www.w3.org/2000/svg" width="120" height="27" viewBox="0 5 595 116" aria-labelledby="ons-logo-stacked-en-alt">
            <title id="ons-logo-stacked-en-alt">Office for National Statistics logo</title>
            <g class="ons-svg-logo__group ons-svg-logo__group--secondary" fill="#a8bd3a">
                <path d="M0,70.5c1.8-3.7,3.6-7.2,5.6-10.7A127.94,127.94,0,0,1,0,42.6V70.5M10.9,0S0,0,0,13.5v7.2A128.06,128.06,0,0,0,7.9,56.2a114.75,114.75,0,0,1,22.3-26C47.8,15.1,71.5,4.7,103.7.1Z"/>
            </g>
            <g class="ons-svg-logo__group ons-svg-logo__group--primary" fill="#003c57">
                <path d="M115.9,7.3c-36.8,3.5-62,14-80,29.4a108.15,108.15,0,0,0-23.6,29c14.1,27.4,41.1,47.6,86,50.5h4.4s13.8.5,13.8-14.9V7.2l-.6.1M21.2,85.4a92.68,92.68,0,0,1-11-16A173,173,0,0,0,0,93.4v22.7l73.6.1c-22.9-5.5-40.1-16.4-52.4-30.8"/>
            </g>
            <g class="ons-svg-logo__group ons-svg-logo__group--text" fill="#003c57">
                <path d="M161,51.9c-11.3,0-16.3-9.3-16.3-20.8s5-20.8,16.3-20.8,16.3,9.5,16.3,20.8c-.1,11.5-5.1,20.8-16.3,20.8m0-38.3c-8.3,0-11.3,9.1-11.3,17.4s2.7,17.3,11.3,17.3,11.2-9.1,11.2-17.3S169.3,13.6,161,13.6m30.2,8.9V51.2h-4.5V22.6H182V19.8h4.7V15.2c0-5.7,3.4-9.9,10-9.9a8,8,0,0,1,1.1.1V8.3h-.5c-3.2,0-6,2.1-6,6.4v5.1h6.6v2.8l-6.7-.1Zm18.9,0V51.2h-4.5V22.6h-4.7V19.8h4.7V15.2c0-5.7,3.4-9.9,10-9.9a8,8,0,0,1,1.1.1V8.3h-.5c-3.2,0-6,2.1-6,6.4v5.1h6.6v2.8l-6.7-.1Zm14-8.8a2.82,2.82,0,0,1-2.9-2.8,2.9,2.9,0,0,1,5.8,0,2.76,2.76,0,0,1-2.9,2.8m-2.3,6h4.6V51.2h-4.6Zm24.3,32.2c-7.4,0-13.2-6.4-13.2-16.5,0-10.3,5.8-16.5,13.4-16.5a12.36,12.36,0,0,1,7.7,2.2l-1.2,2.8a8.92,8.92,0,0,0-5.5-1.7c-6.4,0-9.7,5.5-9.7,13,0,7.7,3.7,13.2,9.5,13.2a9.8,9.8,0,0,0,5.6-1.7l1.2,3c-1.3,1.2-4,2.2-7.8,2.2m15.3-14.6c.6,7.4,4.7,11.1,11.1,11.1a18.36,18.36,0,0,0,8.5-1.9l1.3,3.2a22.58,22.58,0,0,1-10.2,2.1c-8.8,0-15.1-5.3-15.1-16.6,0-10.8,5.8-16.4,13.7-16.4s12.9,4.9,12.9,15.4l-22.2,3.1ZM270.5,22c-5.1,0-9.4,4-9.3,12.8l17.9-2.5C279,25,275.5,22,270.5,22m42.2.5V51.2h-4.5V22.6h-4.7V19.8h4.7V15.2c0-5.7,3.4-9.9,10-9.9a8,8,0,0,1,1.1.1V8.3h-.5c-3.2,0-6,2.1-6,6.4v5.1h6.6v2.8Zm23.2,29.4c-9.3,0-13.5-7.2-13.5-16.5s4.2-16.5,13.5-16.5,13.5,7.2,13.5,16.5-4.2,16.5-13.5,16.5m0-29.8c-6.9,0-8.8,7-8.8,13.4s2.1,13.1,8.8,13.1c6.9,0,8.9-6.6,8.9-13.1s-2-13.4-8.9-13.4m33.3.6c-2.9-.8-7.1-.6-9.1.6V51.2h-4.6V21.1c3.3-1.4,6.6-2.2,12.5-2.2h2.4c0,.1-1.2,3.8-1.2,3.8ZM171.3,114.8,153.5,87.3c-1.3-2.1-2.3-4.1-2.3-4.1h-.1s.2,2.3.2,4.8v26.8h-5.8V74.7h6.6L169,100.5a46.13,46.13,0,0,1,2.4,4.1h.1s-.2-2.3-.2-4.7V74.6h5.9v40.1l-5.9.1Zm25,.8c-9.2,0-13.6-3.7-13.6-9.7,0-8.5,8.8-10.7,19.4-11.7V92.4c0-4.3-2.9-5.6-7.2-5.6a22.34,22.34,0,0,0-8.5,1.8l-1.6-3.8a30.2,30.2,0,0,1,11.3-2.3c7,0,12.3,2.9,12.3,10.9v19.9c-2.7,1.4-6.9,2.3-12.1,2.3m5.8-18.2c-7.8.8-13,2.3-13,8.3,0,4.2,3,6.1,7.7,6.1a12.33,12.33,0,0,0,5.3-1.1Zm24.5,18.1c-6.6,0-9.1-4.3-9.1-8.5V87.5h-4.4V83.4h4.4v-7l6.7-1.9v8.9h6.1v4.1h-6.1v19.2c0,2.5,1.4,4.4,4.3,4.4a5.66,5.66,0,0,0,1.8-.3v4.1a11.47,11.47,0,0,1-3.7.6M239,77.9a3.52,3.52,0,1,1,3.9-3.5,3.71,3.71,0,0,1-3.9,3.5m-3.4,5.5h6.8v31.4h-6.8Zm26.9,32.2c-9.6,0-14.4-7.1-14.4-16.5s4.8-16.6,14.4-16.6,14.3,7.2,14.3,16.6-4.7,16.5-14.3,16.5m0-28.7c-5.8,0-7.5,6.1-7.5,12.2s1.8,11.9,7.5,11.9,7.5-5.8,7.5-11.9-1.7-12.2-7.5-12.2m39.3,27.9V92.3c0-4-3.4-5.5-7.3-5.5a16,16,0,0,0-5.4.9v27.1h-6.7v-30a32.8,32.8,0,0,1,12.5-2.3c8.2,0,13.7,2.8,13.7,9.7v22.6Zm25.7.8c-9.2,0-13.6-3.7-13.6-9.7,0-8.5,8.9-10.7,19.4-11.7V92.4c0-4.3-2.9-5.6-7.2-5.6a22.34,22.34,0,0,0-8.5,1.8L316,84.8a30.2,30.2,0,0,1,11.3-2.3c7,0,12.3,2.9,12.3,10.9v19.9c-2.7,1.4-6.9,2.3-12.1,2.3m5.8-18.2c-7.8.8-13,2.3-13,8.3,0,4.2,3,6.1,7.7,6.1a12.33,12.33,0,0,0,5.3-1.1Zm13.2,17.4V69h6.7v45.8Zm38.6.8a23.94,23.94,0,0,1-10.9-2.3l1.9-4.9a17,17,0,0,0,7.7,1.9c4.7,0,8-2.7,8-6.7,0-8.8-16.7-5.4-16.7-17.9,0-6.4,5.2-11.9,13.3-11.9a20.22,20.22,0,0,1,9.7,2.3l-1.7,4.4a14.57,14.57,0,0,0-7-1.9c-4.3,0-7.2,2.6-7.2,6.4,0,8.6,17.1,4.9,17.1,18.2-.1,7.1-6,12.4-14.2,12.4m31.1-.1c-6.6,0-9.1-4.3-9.1-8.5V87.5h-4.4V83.4h4.4v-7l6.7-1.9v8.9h6.1v4.1h-6.1v19.2a4.07,4.07,0,0,0,4.3,4.4,5.66,5.66,0,0,0,1.8-.3v4.1a12.06,12.06,0,0,1-3.7.6m20.9.1c-9.2,0-13.6-3.7-13.6-9.7,0-8.5,8.9-10.7,19.4-11.7V92.4c0-4.3-2.9-5.6-7.2-5.6a22.34,22.34,0,0,0-8.5,1.8l-1.6-3.8a30.2,30.2,0,0,1,11.3-2.3c7,0,12.3,2.9,12.3,10.9v19.9c-2.6,1.4-6.9,2.3-12.1,2.3m5.8-18.2c-7.8.8-13,2.3-13,8.3,0,4.2,3,6.1,7.7,6.1a12.33,12.33,0,0,0,5.3-1.1Zm24.6,18.1c-6.6,0-9.1-4.3-9.1-8.5V87.5H454V83.4h4.4v-7l6.7-1.9v8.9h6.1v4.1h-6.1v19.2a4.07,4.07,0,0,0,4.3,4.4,5.66,5.66,0,0,0,1.8-.3v4.1a12.69,12.69,0,0,1-3.7.6m12.3-37.6a3.52,3.52,0,1,1,3.9-3.5,3.65,3.65,0,0,1-3.9,3.5m-3.4,5.5h6.8v31.4h-6.8Zm21.4,32.2a19.46,19.46,0,0,1-9.5-2.3l1.8-4.3a13.21,13.21,0,0,0,6.9,1.9c3.4,0,6.2-2.2,6.2-4.9,0-7.5-13.8-4-13.8-14.2,0-4.7,4.2-9.2,11-9.2a16.21,16.21,0,0,1,8.8,2.3l-1.8,3.9a10.31,10.31,0,0,0-5.7-1.8c-3.5,0-5.6,2.1-5.6,4.5,0,7,14,3.9,14,14.4,0,4.9-4.7,9.7-12.3,9.7m29.4-.1c-6.6,0-9.1-4.3-9.1-8.5V87.5h-4.4V83.4h4.4v-7l6.7-1.9v8.9h6.1v4.1h-6.1v19.2c0,2.5,1.4,4.4,4.3,4.4a5.66,5.66,0,0,0,1.8-.3v4.1a12.06,12.06,0,0,1-3.7.6m12.3-37.6a3.52,3.52,0,1,1,3.9-3.5c.1,2-1.7,3.5-3.9,3.5m-3.3,5.5H543v31.4h-6.8Zm26.2,32.2c-7.7,0-13.6-6.3-13.6-16.6s6.1-16.5,13.7-16.5c3.9,0,6.6,1.1,8,2.3L569,88.6a8.61,8.61,0,0,0-4.9-1.5c-5.5,0-8.3,4.7-8.3,11.8s3.3,11.9,8.2,11.9a8.39,8.39,0,0,0,4.9-1.6l1.7,4.1c-1.5,1.2-4.2,2.3-8.2,2.3m20.6,0a19.46,19.46,0,0,1-9.5-2.3l1.8-4.3a13.21,13.21,0,0,0,6.9,1.9c3.4,0,6.2-2.2,6.2-4.9,0-7.5-13.8-4-13.8-14.2,0-4.7,4.2-9.2,11-9.2a16.85,16.85,0,0,1,8.9,2.3l-1.8,3.9A10.31,10.31,0,0,0,587,87c-3.5,0-5.6,2.1-5.6,4.5,0,7,14,3.9,14,14.4-.1,4.9-4.9,9.7-12.4,9.7"/>
            </g>
        </svg>
    

                            
                        </div>
                        
                    </div>
                    
                </div>
            </div>
            
        </div>
        <div class="ons-header__main">
            <div class="ons-container">
                <div class="ons-grid ons-grid--gutterless ons-grid--flex ons-grid--between ons-grid--vertical-center ons-grid--no-wrap">
                    <div class="ons-grid__col ons-col-auto ons-u-flex-shrink">
                        
                            
                                <div class="ons-header__title">Sml Python Small Library Reference</div>
                            
                        
                        
                    </div>

                    
                    
                </div>
            </div>
        </div>
        
    </header>

                    
                    
                        <div class="ons-page__container ons-container">
                            
                                
                            
                            <div class="ons-grid">
                                <div class="ons-grid__col ons-col-12@m ">
                                    <main id="main-content" class="ons-page__main ">
                                        
        <section class="p-md-5 section-content">
    <article>
        <p><div class="doc doc-object doc-module">


<a id="sml_small.editing.totals_and_components.totals_and_components"></a>
  <div class="doc doc-contents first">
  
      <p>Perform Totals and Components processing against provided data inputs
based on user supplied thresholds.</p>
<p>For Copyright information, please see LICENCE.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.ComponentPair">
        <code>ComponentPair</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>A class to create value pairs for components</p>


        <details class="quote">
          <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ComponentPair</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to create value pairs for components</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">original_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">final_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor function</span>

<span class="sd">        :param original_value: original value for other methods to use</span>
<span class="sd">        :type original_value: float</span>
<span class="sd">        :param final_value: final value to be set later in the method</span>
<span class="sd">        :type final_value: Optional[float]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_value</span> <span class="o">=</span> <span class="n">original_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_value</span> <span class="o">=</span> <span class="n">final_value</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to determine equality between ComponentList objects</span>

<span class="sd">        :param other: ComponentList object to compare the current object too</span>
<span class="sd">        :type other: ComponentPair</span>
<span class="sd">        ...</span>
<span class="sd">        :return: Boolean, True if equality test passes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ComponentPair</span><span class="p">):</span>
            <span class="c1"># don&#39;t attempt to compare against unrelated types</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">original_value</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">original_value</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_value</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">final_value</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.ComponentPair.__eq__">
<code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Function to determine equality between ComponentList objects</p>
<p>:param other: ComponentList object to compare the current object too
:type other: ComponentPair
...
:return: Boolean, True if equality test passes</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to determine equality between ComponentList objects</span>

<span class="sd">    :param other: ComponentList object to compare the current object too</span>
<span class="sd">    :type other: ComponentPair</span>
<span class="sd">    ...</span>
<span class="sd">    :return: Boolean, True if equality test passes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ComponentPair</span><span class="p">):</span>
        <span class="c1"># don&#39;t attempt to compare against unrelated types</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_value</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">original_value</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_value</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">final_value</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.ComponentPair.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">original_value</span><span class="p">,</span> <span class="n">final_value</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Constructor function</p>
<p>:param original_value: original value for other methods to use
:type original_value: float
:param final_value: final value to be set later in the method
:type final_value: Optional[float]</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">original_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">final_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor function</span>

<span class="sd">    :param original_value: original value for other methods to use</span>
<span class="sd">    :type original_value: float</span>
<span class="sd">    :param final_value: final value to be set later in the method</span>
<span class="sd">    :type final_value: Optional[float]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">original_value</span> <span class="o">=</span> <span class="n">original_value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">final_value</span> <span class="o">=</span> <span class="n">final_value</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.Index">
        <code>Index</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p>Enum for use when accessing values from thresholds tuple</p>


        <details class="quote">
          <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Index</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enum for use when accessing values from thresholds tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">LOW_THRESHOLD</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">HIGH_THRESHOLD</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.InputParameters">
        <code>InputParameters</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p>Enum for use when accessing values from the input parameters tuple</p>


        <details class="quote">
          <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InputParameters</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enum for use when accessing values from the input parameters tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">TOTAL</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">COMPONENTS</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">PREDICTIVE</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">AUXILIARY</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">ABSOLUTE_DIFFERENCE_THRESHOLD</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">PERCENTAGE_DIFFERENCE_THRESHOLD</span> <span class="o">=</span> <span class="mi">5</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.TACException">
        <code>TACException</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>Exception</code></p>

  
      <p>Totals and Components error</p>


        <details class="quote">
          <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TACException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="s2">&quot;Totals and Components error&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.TccMarker">
        <code>TccMarker</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p>Enum for use when setting/comparing tcc_marker values</p>


        <details class="quote">
          <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TccMarker</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enum for use when setting/comparing tcc_marker values</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">STOP</span> <span class="o">=</span> <span class="s2">&quot;S&quot;</span>
    <span class="n">MANUAL</span> <span class="o">=</span> <span class="s2">&quot;M&quot;</span>
    <span class="n">TOTAL_CORRECTED</span> <span class="o">=</span> <span class="s2">&quot;T&quot;</span>
    <span class="n">COMPONENTS_CORRECTED</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>
    <span class="n">NO_CORRECTION</span> <span class="o">=</span> <span class="s2">&quot;N&quot;</span>
    <span class="n">METHOD_PROCEED</span> <span class="o">=</span> <span class="s2">&quot;P&quot;</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to determine equality between ComponentList objects</span>

<span class="sd">        :param value: string to compare against</span>
<span class="sd">        :type value: string</span>
<span class="sd">        ...</span>
<span class="sd">        :return: Boolean, True if equality test passes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.TccMarker.__eq__">
<code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Function to determine equality between ComponentList objects</p>
<p>:param value: string to compare against
:type value: string
...
:return: Boolean, True if equality test passes</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to determine equality between ComponentList objects</span>

<span class="sd">    :param value: string to compare against</span>
<span class="sd">    :type value: string</span>
<span class="sd">    ...</span>
<span class="sd">    :return: Boolean, True if equality test passes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.TotalsAndComponentsOutput">
        <code>TotalsAndComponentsOutput</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>A Class defining the output attributes of the totals and components method</p>


        <details class="quote">
          <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TotalsAndComponentsOutput</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Class defining the output attributes of the totals and components method</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">identifier</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># unique identifier</span>
    <span class="n">absolute_difference</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>  <span class="c1"># this is the absolute value showing the</span>
    <span class="c1"># difference between the components input and the predictive total</span>
    <span class="n">low_percent_threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="nb">str</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># the sum of the input components minus the absolute percentage difference</span>
    <span class="n">high_percent_threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="nb">str</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># the sum of the input components plus the absolute percentage difference</span>
    <span class="n">final_total</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="nb">str</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># the output total which may have been corrected based on user input amend_</span>
    <span class="c1"># total variable</span>
    <span class="n">final_components</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># the output components which may have been corrected to match the received</span>
    <span class="c1"># predictive value. If corrected the components are scaled proportionally</span>
    <span class="c1"># based on the input values</span>
    <span class="n">tcc_marker</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>  <span class="c1"># Indicates what correction (if any) was necessary.</span>

    <span class="c1"># T (totals corrected), C (components corrected),</span>
    <span class="c1"># N (no correction required), M (manual correction required), S</span>
    <span class="c1"># (method stopped due to lack of data or zero values)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        constructor function</span>

<span class="sd">        :param args: dictionary of attributes to set on the object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.TotalsAndComponentsOutput.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>constructor function</p>
<p>:param args: dictionary of attributes to set on the object</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    constructor function</span>

<span class="sd">    :param args: dictionary of attributes to set on the object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.calculate_percent_thresholds">
<code class="highlight language-python"><span class="n">calculate_percent_thresholds</span><span class="p">(</span><span class="n">sum_of_components</span><span class="p">,</span> <span class="n">percentage_threshold</span><span class="p">,</span> <span class="n">output_list</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Calculate and return the low and high percentage thresholds based on the
sum of the received components and the specified percentage threshold factor
(expressed as a decimal)</p>
<p>:param sum_of_components: A sum of the original components list input to the method
:type sum_of_components: Decimal
:param percentage_threshold: If the predictive total is within the specified percentage
                                of the sum of the components, the method will automatically
                                correct.
:type percentage_threshold: Decimal
:param output_list: dictionary containing attributes output at the end of the totals and
components function
:type output_list: dict
...
:return: low_percent_threshold, The lower threshold calculated from the sum of components
                                and percentage threshold
:rtype: Decimal
:return: high_percent_threshold The upper threshold calculated from the sum of components
                                 and percentage threshold
:rtype: Decimal
:return: output_list, dictionary containing attributes output at the end of the totals and
components function
:rtype: dict</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">calculate_percent_thresholds</span><span class="p">(</span>
    <span class="n">sum_of_components</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span>
    <span class="n">percentage_threshold</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span>
    <span class="n">output_list</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Decimal</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">Union</span><span class="p">[</span><span class="n">Decimal</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate and return the low and high percentage thresholds based on the</span>
<span class="sd">    sum of the received components and the specified percentage threshold factor</span>
<span class="sd">    (expressed as a decimal)</span>

<span class="sd">    :param sum_of_components: A sum of the original components list input to the method</span>
<span class="sd">    :type sum_of_components: Decimal</span>
<span class="sd">    :param percentage_threshold: If the predictive total is within the specified percentage</span>
<span class="sd">                                    of the sum of the components, the method will automatically</span>
<span class="sd">                                    correct.</span>
<span class="sd">    :type percentage_threshold: Decimal</span>
<span class="sd">    :param output_list: dictionary containing attributes output at the end of the totals and</span>
<span class="sd">    components function</span>
<span class="sd">    :type output_list: dict</span>
<span class="sd">    ...</span>
<span class="sd">    :return: low_percent_threshold, The lower threshold calculated from the sum of components</span>
<span class="sd">                                    and percentage threshold</span>
<span class="sd">    :rtype: Decimal</span>
<span class="sd">    :return: high_percent_threshold The upper threshold calculated from the sum of components</span>
<span class="sd">                                     and percentage threshold</span>
<span class="sd">    :rtype: Decimal</span>
<span class="sd">    :return: output_list, dictionary containing attributes output at the end of the totals and</span>
<span class="sd">    components function</span>
<span class="sd">    :rtype: dict</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">percentage_threshold</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">low_percent_threshold</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">high_percent_threshold</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">low_percent_threshold</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span>
            <span class="n">sum_of_components</span> <span class="o">-</span> <span class="p">(</span><span class="n">sum_of_components</span> <span class="o">*</span> <span class="n">percentage_threshold</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">high_percent_threshold</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span>
            <span class="n">sum_of_components</span> <span class="o">+</span> <span class="p">(</span><span class="n">sum_of_components</span> <span class="o">*</span> <span class="n">percentage_threshold</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;low_percent_threshold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">low_percent_threshold</span>
    <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;high_percent_threshold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">high_percent_threshold</span>

    <span class="k">return</span> <span class="n">low_percent_threshold</span><span class="p">,</span> <span class="n">high_percent_threshold</span><span class="p">,</span> <span class="n">output_list</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.check_absolute_difference_threshold">
<code class="highlight language-python"><span class="n">check_absolute_difference_threshold</span><span class="p">(</span><span class="n">absolute_difference_threshold</span><span class="p">,</span> <span class="n">absolute_difference</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function to determine whether error correction can be applied automatically
based on the calculated difference between the sum of components and the predictive
value and the specified difference threshold</p>
<p>:param absolute_difference_threshold: Value used to check if the difference
                                      between the predictive total and sum of
                                      components requires an automatic update.
:type absolute_difference_threshold: Decimal
:param absolute_difference: The absolute value showing the difference between
                            the input components and the predictive total.
:type absolute_difference: Decimal
...
:return: correct_error a flag indicating if the threshold is satisfied and
                       automatic correction can be applied
:rtype: bool</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_absolute_difference_threshold</span><span class="p">(</span>
    <span class="n">absolute_difference_threshold</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">absolute_difference</span><span class="p">:</span> <span class="n">Decimal</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to determine whether error correction can be applied automatically</span>
<span class="sd">    based on the calculated difference between the sum of components and the predictive</span>
<span class="sd">    value and the specified difference threshold</span>

<span class="sd">    :param absolute_difference_threshold: Value used to check if the difference</span>
<span class="sd">                                          between the predictive total and sum of</span>
<span class="sd">                                          components requires an automatic update.</span>
<span class="sd">    :type absolute_difference_threshold: Decimal</span>
<span class="sd">    :param absolute_difference: The absolute value showing the difference between</span>
<span class="sd">                                the input components and the predictive total.</span>
<span class="sd">    :type absolute_difference: Decimal</span>
<span class="sd">    ...</span>
<span class="sd">    :return: correct_error a flag indicating if the threshold is satisfied and</span>
<span class="sd">                           automatic correction can be applied</span>
<span class="sd">    :rtype: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">correct_error</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">absolute_difference</span> <span class="o">&lt;=</span> <span class="n">absolute_difference_threshold</span><span class="p">:</span>
        <span class="n">correct_error</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">correct_error</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.check_percentage_difference_threshold">
<code class="highlight language-python"><span class="n">check_percentage_difference_threshold</span><span class="p">(</span><span class="n">predictive</span><span class="p">,</span> <span class="n">low_threshold</span><span class="p">,</span> <span class="n">high_threshold</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function to determine whether error correction can be applied automatically
based on the calculated low and high threshold based on the received sum of
components compared to the predictive value</p>
<p>:param predictive: The received predictive value, this could be based off
                   of the current total, predictive total or auxiliary
                   value dependant upon what values where passed to the
                   top level totals_and_components function.
:type predictive: Decimal
:param low_threshold: Low percentage threshold previously
                   calculated from the percentage_difference_threshold and
                   input components
:type low_threshold: Decimal
 :param high_threshold: High percentage threshold previously
                   calculated from the percentage_difference_threshold and
                   input components
:type high_threshold: Decimal
...
:return: correct_error a marker indicating if the threshold is satisfied
:rtype: bool</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_percentage_difference_threshold</span><span class="p">(</span>
    <span class="n">predictive</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">low_threshold</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">high_threshold</span><span class="p">:</span> <span class="n">Decimal</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to determine whether error correction can be applied automatically</span>
<span class="sd">    based on the calculated low and high threshold based on the received sum of</span>
<span class="sd">    components compared to the predictive value</span>

<span class="sd">    :param predictive: The received predictive value, this could be based off</span>
<span class="sd">                       of the current total, predictive total or auxiliary</span>
<span class="sd">                       value dependant upon what values where passed to the</span>
<span class="sd">                       top level totals_and_components function.</span>
<span class="sd">    :type predictive: Decimal</span>
<span class="sd">    :param low_threshold: Low percentage threshold previously</span>
<span class="sd">                       calculated from the percentage_difference_threshold and</span>
<span class="sd">                       input components</span>
<span class="sd">    :type low_threshold: Decimal</span>
<span class="sd">     :param high_threshold: High percentage threshold previously</span>
<span class="sd">                       calculated from the percentage_difference_threshold and</span>
<span class="sd">                       input components</span>
<span class="sd">    :type high_threshold: Decimal</span>
<span class="sd">    ...</span>
<span class="sd">    :return: correct_error a marker indicating if the threshold is satisfied</span>
<span class="sd">    :rtype: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">correct_error</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">low_threshold</span> <span class="o">&lt;=</span> <span class="n">predictive</span> <span class="o">&lt;=</span> <span class="n">high_threshold</span><span class="p">:</span>
        <span class="n">correct_error</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">correct_error</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.check_sum_components_predictive">
<code class="highlight language-python"><span class="n">check_sum_components_predictive</span><span class="p">(</span><span class="n">predictive</span><span class="p">,</span> <span class="n">components_sum</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Calculates the absolute difference between the predictive value and the sum of the
components and returns that value</p>
<p>:param predictive: This is the predictive value used in the absolute difference calculation.
:type predictive: Decimal
:param components_sum: total sum of all the components values entered.
:type components_sum: Decimal
...
:return: Returns the absolute difference between the received predictive value and the received
         sum of the components as a Decimal.
:rtype: Decimal</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_sum_components_predictive</span><span class="p">(</span>
    <span class="n">predictive</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">components_sum</span><span class="p">:</span> <span class="n">Decimal</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Decimal</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the absolute difference between the predictive value and the sum of the</span>
<span class="sd">    components and returns that value</span>

<span class="sd">    :param predictive: This is the predictive value used in the absolute difference calculation.</span>
<span class="sd">    :type predictive: Decimal</span>
<span class="sd">    :param components_sum: total sum of all the components values entered.</span>
<span class="sd">    :type components_sum: Decimal</span>
<span class="sd">    ...</span>
<span class="sd">    :return: Returns the absolute difference between the received predictive value and the received</span>
<span class="sd">             sum of the components as a Decimal.</span>
<span class="sd">    :rtype: Decimal</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">components_sum</span><span class="p">):</span>
        <span class="n">absolute_difference</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">predictive</span> <span class="o">-</span> <span class="n">components_sum</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">absolute_difference</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">predictive</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">absolute_difference</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.check_zero_errors">
<code class="highlight language-python"><span class="n">check_zero_errors</span><span class="p">(</span><span class="n">predictive</span><span class="p">,</span> <span class="n">components_sum</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Stop method processing when the predictive value is positive but the sum of components is zero.
In these scenarios a correction is not possible.</p>
<p>:param predictive: The predictive value, typically the total.
:type predictive: Decimal
:param components_sum: total sum of all the components values entered.
:type components_sum: Decimal
...
:return: tcc_marker, return a value of STOP if zero error is triggered
:rtype: TccMarker</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_zero_errors</span><span class="p">(</span><span class="n">predictive</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">components_sum</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TccMarker</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stop method processing when the predictive value is positive but the sum of components is zero.</span>
<span class="sd">    In these scenarios a correction is not possible.</span>

<span class="sd">    :param predictive: The predictive value, typically the total.</span>
<span class="sd">    :type predictive: Decimal</span>
<span class="sd">    :param components_sum: total sum of all the components values entered.</span>
<span class="sd">    :type components_sum: Decimal</span>
<span class="sd">    ...</span>
<span class="sd">    :return: tcc_marker, return a value of STOP if zero error is triggered</span>
<span class="sd">    :rtype: TccMarker</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">predictive</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">components_sum</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">components_sum</span><span class="p">)):</span>
        <span class="n">tcc_marker</span> <span class="o">=</span> <span class="n">TccMarker</span><span class="o">.</span><span class="n">STOP</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TCCMarker = STOP at line:</span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_lineno</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tcc_marker</span> <span class="o">=</span> <span class="n">TccMarker</span><span class="o">.</span><span class="n">METHOD_PROCEED</span>
    <span class="k">return</span> <span class="n">tcc_marker</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.clean_component_list">
<code class="highlight language-python"><span class="n">clean_component_list</span><span class="p">(</span><span class="n">components</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Takes a list of components and ensures that any empty values are treated as nan</p>
<p>:param components: list of components
:type components: List[]
:return: cleaned_components
:rtype: List[]</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clean_component_list</span><span class="p">(</span><span class="n">components</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Decimal</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes a list of components and ensures that any empty values are treated as nan</span>

<span class="sd">    :param components: list of components</span>
<span class="sd">    :type components: List[]</span>
<span class="sd">    :return: cleaned_components</span>
<span class="sd">    :rtype: List[]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">components</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">)</span> <span class="ow">and</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">component</span><span class="p">):</span>
            <span class="n">components</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span>

    <span class="n">cleaned_components</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">component</span><span class="p">)</span> <span class="k">if</span> <span class="n">component</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">component</span><span class="p">)</span> <span class="k">else</span> <span class="n">component</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">components</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">cleaned_components</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.correct_components">
<code class="highlight language-python"><span class="n">correct_components</span><span class="p">(</span><span class="n">components_sum</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function to correct the components values to add up to the received total value,
set the final total as the received total and indicate that the components
have been corrected. Calculates each component value based on the original value so
values are weighted instead of normalised. Once corrections have taken place if
the sum of the corrected components does not match the desired total the code
adjusts the last component that has a positive value to ensure the sum of components
does equal the target value. If the last component is Nan or 0 the method goes
to the previous component in the list until it finds a valid number to correct.</p>
<p>:param components_sum: Sum of original values of components list
:type components_sum: Decimal
:param components: a list that includes the original component
                   values received, these are used when calculating the
                   amended component values to retain the original weighting.
:type components: list(Components_list)
:param total: current total
:type total: Decimal
...
:return: final_total, final total value to be output
:rtype: Decimal
:return: components Input Component list with final values updated
:rtype: list(Components_list)
:return: tcc_marker, Returned Tcc_Marker (Components_corrected)
:rtyper: TccMarker</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_components</span><span class="p">(</span>
    <span class="n">components_sum</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span>
    <span class="n">components</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ComponentPair</span><span class="p">],</span>
    <span class="n">total</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Decimal</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">ComponentPair</span><span class="p">],</span> <span class="n">TccMarker</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to correct the components values to add up to the received total value,</span>
<span class="sd">    set the final total as the received total and indicate that the components</span>
<span class="sd">    have been corrected. Calculates each component value based on the original value so</span>
<span class="sd">    values are weighted instead of normalised. Once corrections have taken place if</span>
<span class="sd">    the sum of the corrected components does not match the desired total the code</span>
<span class="sd">    adjusts the last component that has a positive value to ensure the sum of components</span>
<span class="sd">    does equal the target value. If the last component is Nan or 0 the method goes</span>
<span class="sd">    to the previous component in the list until it finds a valid number to correct.</span>

<span class="sd">    :param components_sum: Sum of original values of components list</span>
<span class="sd">    :type components_sum: Decimal</span>
<span class="sd">    :param components: a list that includes the original component</span>
<span class="sd">                       values received, these are used when calculating the</span>
<span class="sd">                       amended component values to retain the original weighting.</span>
<span class="sd">    :type components: list(Components_list)</span>
<span class="sd">    :param total: current total</span>
<span class="sd">    :type total: Decimal</span>
<span class="sd">    ...</span>
<span class="sd">    :return: final_total, final total value to be output</span>
<span class="sd">    :rtype: Decimal</span>
<span class="sd">    :return: components Input Component list with final values updated</span>
<span class="sd">    :rtype: list(Components_list)</span>
<span class="sd">    :return: tcc_marker, Returned Tcc_Marker (Components_corrected)</span>
<span class="sd">    :rtyper: TccMarker</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">final_total</span> <span class="o">=</span> <span class="n">total</span>
    <span class="n">sum_of_adjusted</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">component_to_correct_position</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># If the component sum does not equal the total then we want to correct the last</span>
    <span class="c1"># component so that the sum matches the total.</span>
    <span class="c1"># If the last final component is NaN or 0 we go to the final component before it.</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">components</span><span class="p">):</span>
        <span class="n">component</span><span class="o">.</span><span class="n">final_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">original_value</span> <span class="o">/</span> <span class="n">components_sum</span><span class="p">)</span> <span class="o">*</span> <span class="n">total</span>
        <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span>
            <span class="n">component</span><span class="o">.</span><span class="n">final_value</span>
        <span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">component</span><span class="o">.</span><span class="n">final_value</span> <span class="o">!=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">):</span>
            <span class="n">sum_of_adjusted</span> <span class="o">=</span> <span class="n">sum_of_adjusted</span> <span class="o">+</span> <span class="n">component</span><span class="o">.</span><span class="n">final_value</span>
            <span class="n">component_to_correct_position</span> <span class="o">=</span> <span class="n">count</span>

    <span class="k">if</span> <span class="n">sum_of_adjusted</span> <span class="o">&gt;</span> <span class="n">final_total</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;correct component fine tune down - </span><span class="si">{</span><span class="n">sum_of_adjusted</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">final_total</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">components</span><span class="p">[</span><span class="n">component_to_correct_position</span><span class="p">]</span><span class="o">.</span><span class="n">final_value</span> <span class="o">=</span> <span class="n">components</span><span class="p">[</span>
            <span class="n">component_to_correct_position</span>
        <span class="p">]</span><span class="o">.</span><span class="n">final_value</span> <span class="o">-</span> <span class="p">(</span><span class="n">sum_of_adjusted</span> <span class="o">-</span> <span class="n">final_total</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">sum_of_adjusted</span> <span class="o">&lt;</span> <span class="n">final_total</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;correct component fine tune up - </span><span class="si">{</span><span class="n">sum_of_adjusted</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">final_total</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">components</span><span class="p">[</span><span class="n">component_to_correct_position</span><span class="p">]</span><span class="o">.</span><span class="n">final_value</span> <span class="o">=</span> <span class="n">components</span><span class="p">[</span>
            <span class="n">component_to_correct_position</span>
        <span class="p">]</span><span class="o">.</span><span class="n">final_value</span> <span class="o">+</span> <span class="p">(</span><span class="n">final_total</span> <span class="o">-</span> <span class="n">sum_of_adjusted</span><span class="p">)</span>

    <span class="n">tcc_marker</span> <span class="o">=</span> <span class="n">TccMarker</span><span class="o">.</span><span class="n">COMPONENTS_CORRECTED</span>
    <span class="k">return</span> <span class="n">final_total</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">tcc_marker</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.correct_total">
<code class="highlight language-python"><span class="n">correct_total</span><span class="p">(</span><span class="n">components_sum</span><span class="p">,</span> <span class="n">original_components</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function to correct the total value</p>
<p>:param components_sum: Sum of original values of components list
:type components_sum: Decimal
:param original_components: List of Components objects so final values can be amended
:type original_components: list(Components_list)
...
:return:  final_total, final total value to be output
:rtype: Decimal
:return: original_components, Input Component list with final values updated
:rtype: list(Components_list)
:return: tcc_marker, Returned Tcc_Marker (Total_corrected)
:rtype: TccMarker</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_total</span><span class="p">(</span>
    <span class="n">components_sum</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">original_components</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ComponentPair</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Decimal</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">ComponentPair</span><span class="p">],</span> <span class="n">TccMarker</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to correct the total value</span>

<span class="sd">    :param components_sum: Sum of original values of components list</span>
<span class="sd">    :type components_sum: Decimal</span>
<span class="sd">    :param original_components: List of Components objects so final values can be amended</span>
<span class="sd">    :type original_components: list(Components_list)</span>
<span class="sd">    ...</span>
<span class="sd">    :return:  final_total, final total value to be output</span>
<span class="sd">    :rtype: Decimal</span>
<span class="sd">    :return: original_components, Input Component list with final values updated</span>
<span class="sd">    :rtype: list(Components_list)</span>
<span class="sd">    :return: tcc_marker, Returned Tcc_Marker (Total_corrected)</span>
<span class="sd">    :rtype: TccMarker</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">final_total</span> <span class="o">=</span> <span class="n">components_sum</span>

    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">original_components</span><span class="p">:</span>
        <span class="n">component</span><span class="o">.</span><span class="n">final_value</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">original_value</span>

    <span class="n">tcc_marker</span> <span class="o">=</span> <span class="n">TccMarker</span><span class="o">.</span><span class="n">TOTAL_CORRECTED</span>

    <span class="k">return</span> <span class="n">final_total</span><span class="p">,</span> <span class="n">original_components</span><span class="p">,</span> <span class="n">tcc_marker</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.determine_error_detection">
<code class="highlight language-python"><span class="n">determine_error_detection</span><span class="p">(</span><span class="n">absolute_difference_threshold</span><span class="p">,</span> <span class="n">percentage_difference_threshold</span><span class="p">,</span> <span class="n">absolute_difference</span><span class="p">,</span> <span class="n">predictive</span><span class="p">,</span> <span class="n">low_threshold</span><span class="p">,</span> <span class="n">high_threshold</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Determines and calls the relevant error detection methods to be applied to the input</p>
<p>:param absolute_difference_threshold: Value used to check if the difference
                                      between the predictive total and sum
                                      of components requires an automatic update.
:type absolute_difference_threshold: None | Decimal
:param percentage_difference_threshold: If the predictive total is within the
                                        specified percentage of the sum of the
                                        components, the method will
                                        automatically correct.
:type percentage_difference_threshold: None | Decimal
:param absolute_difference: The absolute value showing the difference between
                            the input components and the predictive total.
:type absolute_difference: Decimal
:param predictive: The predictive value, typically the total.
:type predictive: Decimal
:param low_threshold: Low percentage threshold previously
                   calculated from the percentage_difference_threshold and
                   input components
:type low_threshold: Decimal | None
:param high_threshold: High percentage threshold previously
                   calculated from the percentage_difference_threshold and
                   input components
:type high_threshold: Decimal | None
...
:return: TCC_Marker, Returned Tcc_Marker (either stop or continue)
:rtype: TccMarker</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">determine_error_detection</span><span class="p">(</span>
    <span class="n">absolute_difference_threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Decimal</span><span class="p">],</span>
    <span class="n">percentage_difference_threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Decimal</span><span class="p">],</span>
    <span class="n">absolute_difference</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span>
    <span class="n">predictive</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span>
    <span class="n">low_threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Decimal</span><span class="p">],</span>
    <span class="n">high_threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Decimal</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TccMarker</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines and calls the relevant error detection methods to be applied to the input</span>

<span class="sd">    :param absolute_difference_threshold: Value used to check if the difference</span>
<span class="sd">                                          between the predictive total and sum</span>
<span class="sd">                                          of components requires an automatic update.</span>
<span class="sd">    :type absolute_difference_threshold: None | Decimal</span>
<span class="sd">    :param percentage_difference_threshold: If the predictive total is within the</span>
<span class="sd">                                            specified percentage of the sum of the</span>
<span class="sd">                                            components, the method will</span>
<span class="sd">                                            automatically correct.</span>
<span class="sd">    :type percentage_difference_threshold: None | Decimal</span>
<span class="sd">    :param absolute_difference: The absolute value showing the difference between</span>
<span class="sd">                                the input components and the predictive total.</span>
<span class="sd">    :type absolute_difference: Decimal</span>
<span class="sd">    :param predictive: The predictive value, typically the total.</span>
<span class="sd">    :type predictive: Decimal</span>
<span class="sd">    :param low_threshold: Low percentage threshold previously</span>
<span class="sd">                       calculated from the percentage_difference_threshold and</span>
<span class="sd">                       input components</span>
<span class="sd">    :type low_threshold: Decimal | None</span>
<span class="sd">    :param high_threshold: High percentage threshold previously</span>
<span class="sd">                       calculated from the percentage_difference_threshold and</span>
<span class="sd">                       input components</span>
<span class="sd">    :type high_threshold: Decimal | None</span>
<span class="sd">    ...</span>
<span class="sd">    :return: TCC_Marker, Returned Tcc_Marker (either stop or continue)</span>
<span class="sd">    :rtype: TccMarker</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">absolute_difference_threshold</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">percentage_difference_threshold</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">tcc_marker</span> <span class="o">=</span> <span class="n">TccMarker</span><span class="o">.</span><span class="n">MANUAL</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">correct_error</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">absolute_difference_threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">correct_error</span> <span class="o">=</span> <span class="n">check_absolute_difference_threshold</span><span class="p">(</span>
                <span class="n">absolute_difference_threshold</span><span class="p">,</span> <span class="n">absolute_difference</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">percentage_difference_threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">correct_error</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">correct_error</span> <span class="o">=</span> <span class="n">check_percentage_difference_threshold</span><span class="p">(</span>
                <span class="n">predictive</span><span class="p">,</span> <span class="n">low_threshold</span><span class="p">,</span> <span class="n">high_threshold</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">correct_error</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">tcc_marker</span> <span class="o">=</span> <span class="n">TccMarker</span><span class="o">.</span><span class="n">MANUAL</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tcc_marker</span> <span class="o">=</span> <span class="n">TccMarker</span><span class="o">.</span><span class="n">METHOD_PROCEED</span>

    <span class="k">return</span> <span class="n">tcc_marker</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.error_correction">
<code class="highlight language-python"><span class="n">error_correction</span><span class="p">(</span><span class="n">amend_total</span><span class="p">,</span> <span class="n">components_sum</span><span class="p">,</span> <span class="n">original_components</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>The error correction function will use the amend_total to either
correct the total or components. Correcting the total will set the final
total as the sum of components. Correcting the components will return the
new adjusted components that have been adjusted by using the total.</p>
<p>:param amend_total: Specifies whether the total or components should be corrected
                    when an error is detected.
:type amend_total: bool
:param total: Total value specified when the main totals_and_components method is
              called, this is typically the total value associated with the
              most current data received.
:type total: Decimal
:param components_sum: Sum of original values of components list
:type components_sum: Decimal
:param original_components: List of Components objects so final values can be amended
:type original_components: list(ComponentPair)
...
:return: final_total final total value to be output
:rtype: Decimal
:return: original_components Updated final values list to be output
:rtype: list(Decimal)
:return: tcc_marker Returned Tcc_Marker (either total corrected or components corrected)
:rtype: TccMarker</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">error_correction</span><span class="p">(</span>
    <span class="n">amend_total</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">components_sum</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span>
    <span class="n">original_components</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ComponentPair</span><span class="p">],</span>
    <span class="n">total</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Decimal</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Decimal</span><span class="p">],</span> <span class="n">TccMarker</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The error correction function will use the amend_total to either</span>
<span class="sd">    correct the total or components. Correcting the total will set the final</span>
<span class="sd">    total as the sum of components. Correcting the components will return the</span>
<span class="sd">    new adjusted components that have been adjusted by using the total.</span>

<span class="sd">    :param amend_total: Specifies whether the total or components should be corrected</span>
<span class="sd">                        when an error is detected.</span>
<span class="sd">    :type amend_total: bool</span>
<span class="sd">    :param total: Total value specified when the main totals_and_components method is</span>
<span class="sd">                  called, this is typically the total value associated with the</span>
<span class="sd">                  most current data received.</span>
<span class="sd">    :type total: Decimal</span>
<span class="sd">    :param components_sum: Sum of original values of components list</span>
<span class="sd">    :type components_sum: Decimal</span>
<span class="sd">    :param original_components: List of Components objects so final values can be amended</span>
<span class="sd">    :type original_components: list(ComponentPair)</span>
<span class="sd">    ...</span>
<span class="sd">    :return: final_total final total value to be output</span>
<span class="sd">    :rtype: Decimal</span>
<span class="sd">    :return: original_components Updated final values list to be output</span>
<span class="sd">    :rtype: list(Decimal)</span>
<span class="sd">    :return: tcc_marker Returned Tcc_Marker (either total corrected or components corrected)</span>
<span class="sd">    :rtype: TccMarker</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">amend_total</span><span class="p">:</span>
        <span class="n">final_total</span><span class="p">,</span> <span class="n">original_components</span><span class="p">,</span> <span class="n">tcc_marker</span> <span class="o">=</span> <span class="n">correct_total</span><span class="p">(</span>
            <span class="n">components_sum</span><span class="p">,</span> <span class="n">original_components</span>
        <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">final_total</span><span class="p">,</span> <span class="n">original_components</span><span class="p">,</span> <span class="n">tcc_marker</span> <span class="o">=</span> <span class="n">correct_components</span><span class="p">(</span>
            <span class="n">components_sum</span><span class="p">,</span> <span class="n">original_components</span><span class="p">,</span> <span class="n">total</span>
        <span class="p">)</span>

    <span class="n">final_components</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">original_components</span><span class="p">:</span>
        <span class="n">final_components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">final_value</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">final_total</span><span class="p">,</span> <span class="n">final_components</span><span class="p">,</span> <span class="n">tcc_marker</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.initialize_components_list">
<code class="highlight language-python"><span class="n">initialize_components_list</span><span class="p">(</span><span class="n">component_list</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Takes the list of components values and constructs Component_List objects from them</p>
<p>:param component_list: List of component values, the sum of which, should match the received total value.
:type component_list: list(Decimal)
...
:return: component_object_list List of components stored within ComponentsList objects
:rtype: list(ComponentsList)</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_components_list</span><span class="p">(</span>
    <span class="n">component_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Decimal</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ComponentPair</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes the list of components values and constructs Component_List objects from them</span>

<span class="sd">    :param component_list: List of component values, the sum of which, should match the received total value.</span>
<span class="sd">    :type component_list: list(Decimal)</span>
<span class="sd">    ...</span>
<span class="sd">    :return: component_object_list List of components stored within ComponentsList objects</span>
<span class="sd">    :rtype: list(ComponentsList)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">component_object_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">component_list</span><span class="p">:</span>
        <span class="n">component_object_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ComponentPair</span><span class="p">(</span><span class="n">component</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">component_object_list</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.set_predictive_value">
<code class="highlight language-python"><span class="n">set_predictive_value</span><span class="p">(</span><span class="n">predictive</span><span class="p">,</span> <span class="n">auxiliary</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks if predictive and auxiliary values are input, when predictive is None but auxiliary
is available set predictive to auxiliary. If auxiliary is also None use the total value.</p>
<p>:param predictive: The predictive value.
:type predictive: Decimal, optional
:param auxiliary: The value to be used in the absence of a predictive value.
:type auxiliary: Decimal, optional
...
:return: predictive, updated predictive value
:rtype: None | Decimal
:return: tcc_marker, updated tcc_marker value
:rtype: TccMarker</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_predictive_value</span><span class="p">(</span>
    <span class="n">predictive</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Decimal</span><span class="p">],</span>
    <span class="n">auxiliary</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Decimal</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Decimal</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">TccMarker</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if predictive and auxiliary values are input, when predictive is None but auxiliary</span>
<span class="sd">    is available set predictive to auxiliary. If auxiliary is also None use the total value.</span>

<span class="sd">    :param predictive: The predictive value.</span>
<span class="sd">    :type predictive: Decimal, optional</span>
<span class="sd">    :param auxiliary: The value to be used in the absence of a predictive value.</span>
<span class="sd">    :type auxiliary: Decimal, optional</span>
<span class="sd">    ...</span>
<span class="sd">    :return: predictive, updated predictive value</span>
<span class="sd">    :rtype: None | Decimal</span>
<span class="sd">    :return: tcc_marker, updated tcc_marker value</span>
<span class="sd">    :rtype: TccMarker</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">predictive</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">auxiliary</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">predictive</span> <span class="o">=</span> <span class="n">auxiliary</span>
            <span class="n">tcc_marker</span> <span class="o">=</span> <span class="n">TccMarker</span><span class="o">.</span><span class="n">METHOD_PROCEED</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tcc_marker</span> <span class="o">=</span> <span class="n">TccMarker</span><span class="o">.</span><span class="n">STOP</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;TCCMarker = STOP at line:</span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_lineno</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tcc_marker</span> <span class="o">=</span> <span class="n">TccMarker</span><span class="o">.</span><span class="n">METHOD_PROCEED</span>
    <span class="k">return</span> <span class="n">predictive</span><span class="p">,</span> <span class="n">tcc_marker</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.sum_components">
<code class="highlight language-python"><span class="n">sum_components</span><span class="p">(</span><span class="n">components</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns the total sum of a received list of component values</p>
<p>:param components: List of components to be summed together.
:type components list(components_list)
...
:return: total_sum Final total of summed components
:rtype: Decimal</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sum_components</span><span class="p">(</span><span class="n">components</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ComponentPair</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Decimal</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the total sum of a received list of component values</span>

<span class="sd">    :param components: List of components to be summed together.</span>
<span class="sd">    :type components list(components_list)</span>
<span class="sd">    ...</span>
<span class="sd">    :return: total_sum Final total of summed components</span>
<span class="sd">    :rtype: Decimal</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">original_value</span><span class="p">):</span>
            <span class="n">total_sum</span> <span class="o">+=</span> <span class="n">component</span><span class="o">.</span><span class="n">original_value</span>

    <span class="k">return</span> <span class="n">total_sum</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.totals_and_components">
<code class="highlight language-python"><span class="n">totals_and_components</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">amend_total</span><span class="p">,</span> <span class="n">predictive</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">auxiliary</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">absolute_difference_threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">percentage_difference_threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">PRECISION_MAX</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Determines whether a difference exists between a provided total value and the sum of
individual components. In the case where a difference exists the function can decide
whether an automatic correction should be made based on the provided absolute difference
and/or percentage difference thresholds. Where the correction satisfies the given thresholds
the amend_total variable determines whether the correction is applied to the total value
(to match the sum of the given components) or the individual components (so they add up
to the received total). When the components are corrected to match the total then the original
value of the components is taken into account to ensure that the corrected values are weighted
accordingly to maintain the original distribution. If an automatic correction cannot be applied
because the difference is out of bounds of the given thresholds then the function indicates
that a manual correction could be attempted. When there is no difference between the provided
total and the sum of the individual components then the function indicates no correction has
been applied. For exceptional cases where the sum of the original components is zero and a
positive total has been received the function indicates the method stopped processing. When
invalid types are received for the function then an exception will be raised and no output is
generated. It is important to note that the value None is not to be mistaken for zero.
It is actually representative of a null value.</p>
<p>:param identifier: Unique identifier for the calculation.
:type identifier: str
:param total: Original value returned for the total.
:type total: float
:param components: List of component values, the sum of which, should match the received total value.
:type components: List[float]
:param amend_total: Specifies whether the total or components should be corrected when
                    an error is detected.
:type amend_total:bool
:param predictive: The predictive value. When specified, this value is used to determine whether
                   automatic error correction can be applied when comparing to the specified
                   absolute difference or percentage difference thresholds. Typically the predictive
                   value would be the total from an immediately prior period that has been
                   verified as valid.
:type predictive: Optional[float]
:param auxiliary: The value to be used in the absence of a predictive value.
:type auxiliary: Optional[float]
:param absolute_difference_threshold: Value used to check if the difference between
                                      the predictive total and sum of components
                                      requires an automatic update.
:type absolute_difference_threshold: Optional[float]
:param percentage_difference_threshold: If the predictive total is within the specified
                                        percentage of the sum of the components, the
                                        method will automatically correct.
:type percentage_difference_threshold: Optional[float]
:param precision: Precision is used by the decimal package when calculating whether
                  error correction can take place and for the adjustment of either the
                  total or components and ensures the calculations are performed to the
                  specified accuracy. The default precision is specified under PRECISION_MAX
:type precision: Optional[int]
...
:raisesTACException: If invalid values are passed to the function.
...
:return: TotalsAndComponentsOutput: An object containing the
                                   following attributes:
         - identifier (str): Unique identifier.
         - absolute_difference (str): The absolute value showing the difference between
         the input components and
           the predictive total.
         - low_percent_threshold (str, optional): The sum of the input components minus
         the absolute percentage
           difference (default: None).
         - high_percent_threshold (str, optional): The sum of the input components plus
         the absolute percentage
           difference (default: None).
         - final_total (str): The output total, which may have been corrected based on
         the amend_total variable.
         - final_components (List[str]): The output components, which may have been
         corrected to match the received predictive value. If corrected, the components are
           scaled proportionally
         - Tcc_Marker (str): Indicates what correction (if any) was necessary.
            Possible values:
                T (totals corrected),
                C (components corrected), N (no correction required),
                M (manual correction required),
                S (method stopped due to lack of data or zero values).
 :rtype: Tuple(TotalsAndComponentsOutput)</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">totals_and_components</span><span class="p">(</span>
    <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">total</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">components</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">amend_total</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">predictive</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">auxiliary</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">absolute_difference_threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">percentage_difference_threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">precision</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">PRECISION_MAX</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TotalsAndComponentsOutput</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines whether a difference exists between a provided total value and the sum of</span>
<span class="sd">    individual components. In the case where a difference exists the function can decide</span>
<span class="sd">    whether an automatic correction should be made based on the provided absolute difference</span>
<span class="sd">    and/or percentage difference thresholds. Where the correction satisfies the given thresholds</span>
<span class="sd">    the amend_total variable determines whether the correction is applied to the total value</span>
<span class="sd">    (to match the sum of the given components) or the individual components (so they add up</span>
<span class="sd">    to the received total). When the components are corrected to match the total then the original</span>
<span class="sd">    value of the components is taken into account to ensure that the corrected values are weighted</span>
<span class="sd">    accordingly to maintain the original distribution. If an automatic correction cannot be applied</span>
<span class="sd">    because the difference is out of bounds of the given thresholds then the function indicates</span>
<span class="sd">    that a manual correction could be attempted. When there is no difference between the provided</span>
<span class="sd">    total and the sum of the individual components then the function indicates no correction has</span>
<span class="sd">    been applied. For exceptional cases where the sum of the original components is zero and a</span>
<span class="sd">    positive total has been received the function indicates the method stopped processing. When</span>
<span class="sd">    invalid types are received for the function then an exception will be raised and no output is</span>
<span class="sd">    generated. It is important to note that the value None is not to be mistaken for zero.</span>
<span class="sd">    It is actually representative of a null value.</span>

<span class="sd">    :param identifier: Unique identifier for the calculation.</span>
<span class="sd">    :type identifier: str</span>
<span class="sd">    :param total: Original value returned for the total.</span>
<span class="sd">    :type total: float</span>
<span class="sd">    :param components: List of component values, the sum of which, should match the received total value.</span>
<span class="sd">    :type components: List[float]</span>
<span class="sd">    :param amend_total: Specifies whether the total or components should be corrected when</span>
<span class="sd">                        an error is detected.</span>
<span class="sd">    :type amend_total:bool</span>
<span class="sd">    :param predictive: The predictive value. When specified, this value is used to determine whether</span>
<span class="sd">                       automatic error correction can be applied when comparing to the specified</span>
<span class="sd">                       absolute difference or percentage difference thresholds. Typically the predictive</span>
<span class="sd">                       value would be the total from an immediately prior period that has been</span>
<span class="sd">                       verified as valid.</span>
<span class="sd">    :type predictive: Optional[float]</span>
<span class="sd">    :param auxiliary: The value to be used in the absence of a predictive value.</span>
<span class="sd">    :type auxiliary: Optional[float]</span>
<span class="sd">    :param absolute_difference_threshold: Value used to check if the difference between</span>
<span class="sd">                                          the predictive total and sum of components</span>
<span class="sd">                                          requires an automatic update.</span>
<span class="sd">    :type absolute_difference_threshold: Optional[float]</span>
<span class="sd">    :param percentage_difference_threshold: If the predictive total is within the specified</span>
<span class="sd">                                            percentage of the sum of the components, the</span>
<span class="sd">                                            method will automatically correct.</span>
<span class="sd">    :type percentage_difference_threshold: Optional[float]</span>
<span class="sd">    :param precision: Precision is used by the decimal package when calculating whether</span>
<span class="sd">                      error correction can take place and for the adjustment of either the</span>
<span class="sd">                      total or components and ensures the calculations are performed to the</span>
<span class="sd">                      specified accuracy. The default precision is specified under PRECISION_MAX</span>
<span class="sd">    :type precision: Optional[int]</span>
<span class="sd">    ...</span>
<span class="sd">    :raisesTACException: If invalid values are passed to the function.</span>
<span class="sd">    ...</span>
<span class="sd">    :return: TotalsAndComponentsOutput: An object containing the</span>
<span class="sd">                                       following attributes:</span>
<span class="sd">             - identifier (str): Unique identifier.</span>
<span class="sd">             - absolute_difference (str): The absolute value showing the difference between</span>
<span class="sd">             the input components and</span>
<span class="sd">               the predictive total.</span>
<span class="sd">             - low_percent_threshold (str, optional): The sum of the input components minus</span>
<span class="sd">             the absolute percentage</span>
<span class="sd">               difference (default: None).</span>
<span class="sd">             - high_percent_threshold (str, optional): The sum of the input components plus</span>
<span class="sd">             the absolute percentage</span>
<span class="sd">               difference (default: None).</span>
<span class="sd">             - final_total (str): The output total, which may have been corrected based on</span>
<span class="sd">             the amend_total variable.</span>
<span class="sd">             - final_components (List[str]): The output components, which may have been</span>
<span class="sd">             corrected to match the received predictive value. If corrected, the components are</span>
<span class="sd">               scaled proportionally</span>
<span class="sd">             - Tcc_Marker (str): Indicates what correction (if any) was necessary.</span>
<span class="sd">                Possible values:</span>
<span class="sd">                    T (totals corrected),</span>
<span class="sd">                    C (components corrected), N (no correction required),</span>
<span class="sd">                    M (manual correction required),</span>
<span class="sd">                    S (method stopped due to lack of data or zero values).</span>
<span class="sd">     :rtype: Tuple(TotalsAndComponentsOutput)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># we log a table of the input record values</span>
    <span class="n">log_table</span><span class="p">(</span>
        <span class="s2">&quot;Input Table Function&quot;</span><span class="p">,</span>
        <span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
        <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
        <span class="n">amend_total</span><span class="o">=</span><span class="n">amend_total</span><span class="p">,</span>
        <span class="n">predictive</span><span class="o">=</span><span class="n">predictive</span><span class="p">,</span>
        <span class="n">auxiliary</span><span class="o">=</span><span class="n">auxiliary</span><span class="p">,</span>
        <span class="n">absolute_difference_threshold</span><span class="o">=</span><span class="n">absolute_difference_threshold</span><span class="p">,</span>
        <span class="n">percentage_difference_threshold</span><span class="o">=</span><span class="n">percentage_difference_threshold</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">output_list</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;identifier&quot;</span><span class="p">:</span> <span class="n">identifier</span><span class="p">,</span>
            <span class="s2">&quot;final_total&quot;</span><span class="p">:</span> <span class="n">total</span><span class="p">,</span>
            <span class="s2">&quot;final_components&quot;</span><span class="p">:</span> <span class="n">components</span><span class="p">,</span>
            <span class="s2">&quot;low_percent_threshold&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;high_percent_threshold&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;absolute_difference&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">components_list</span> <span class="o">=</span> <span class="n">initialize_components_list</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
        <span class="n">low_threshold</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">high_threshold</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1">#  Check for invalid parameter values and set the precision value</span>
        <span class="c1">#  for decimal calculations</span>
        <span class="n">precision</span> <span class="o">=</span> <span class="n">validate_input</span><span class="p">(</span>
            <span class="n">identifier</span><span class="p">,</span>
            <span class="n">total</span><span class="p">,</span>
            <span class="n">components_list</span><span class="p">,</span>
            <span class="n">amend_total</span><span class="p">,</span>
            <span class="n">predictive</span><span class="p">,</span>
            <span class="n">precision</span><span class="p">,</span>
            <span class="n">auxiliary</span><span class="p">,</span>
            <span class="n">absolute_difference_threshold</span><span class="p">,</span>
            <span class="n">percentage_difference_threshold</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;total&quot;</span><span class="p">,</span>
            <span class="s2">&quot;components&quot;</span><span class="p">,</span>
            <span class="s2">&quot;predictive&quot;</span><span class="p">,</span>
            <span class="s2">&quot;auxiliary&quot;</span><span class="p">,</span>
            <span class="s2">&quot;absolute_difference_threshold&quot;</span><span class="p">,</span>
            <span class="s2">&quot;percentage_difference_threshold&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">total</span><span class="p">,</span>
            <span class="n">components</span><span class="p">,</span>
            <span class="n">predictive</span><span class="p">,</span>
            <span class="n">auxiliary</span><span class="p">,</span>
            <span class="n">absolute_difference_threshold</span><span class="p">,</span>
            <span class="n">percentage_difference_threshold</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="n">decimal_values</span> <span class="o">=</span> <span class="n">convert_input_to_decimal</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span>

        <span class="n">input_parameters</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">decimal_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;total&quot;</span><span class="p">),</span>
            <span class="n">initialize_components_list</span><span class="p">(</span><span class="n">decimal_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;components&quot;</span><span class="p">)),</span>
            <span class="n">decimal_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;predictive&quot;</span><span class="p">),</span>
            <span class="n">decimal_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;auxiliary&quot;</span><span class="p">),</span>
            <span class="n">decimal_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;absolute_difference_threshold&quot;</span><span class="p">),</span>
            <span class="n">decimal_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;percentage_difference_threshold&quot;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1">#  Set the predictive as either the current value, total or auxiliary</span>
        <span class="c1"># depending on what values exist from the data input.</span>
        <span class="p">(</span><span class="n">predictive</span><span class="p">,</span> <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;tcc_marker&quot;</span><span class="p">])</span> <span class="o">=</span> <span class="n">set_predictive_value</span><span class="p">(</span>
            <span class="n">input_parameters</span><span class="p">[</span><span class="n">InputParameters</span><span class="o">.</span><span class="n">PREDICTIVE</span><span class="o">.</span><span class="n">value</span><span class="p">],</span>
            <span class="n">input_parameters</span><span class="p">[</span><span class="n">InputParameters</span><span class="o">.</span><span class="n">AUXILIARY</span><span class="o">.</span><span class="n">value</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">component_total</span> <span class="o">=</span> <span class="n">sum_components</span><span class="p">(</span>
            <span class="n">input_parameters</span><span class="p">[</span><span class="n">InputParameters</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;tcc_marker&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">TccMarker</span><span class="o">.</span><span class="n">METHOD_PROCEED</span><span class="p">:</span>
            <span class="c1">#  Check for error scenarios where the sum of the components is zero and</span>
            <span class="c1">#  a positive predictive value has been received</span>
            <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;tcc_marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">check_zero_errors</span><span class="p">(</span><span class="n">predictive</span><span class="p">,</span> <span class="n">component_total</span><span class="p">)</span>

            <span class="n">absolute_difference</span> <span class="o">=</span> <span class="n">check_sum_components_predictive</span><span class="p">(</span>
                <span class="n">predictive</span><span class="p">,</span> <span class="n">component_total</span>
            <span class="p">)</span>

            <span class="c1">#  Determine if a correction is required</span>
            <span class="k">if</span> <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;tcc_marker&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">TccMarker</span><span class="o">.</span><span class="n">METHOD_PROCEED</span><span class="p">:</span>
                <span class="p">(</span>
                    <span class="n">low_threshold</span><span class="p">,</span>
                    <span class="n">high_threshold</span><span class="p">,</span>
                    <span class="n">output_list</span><span class="p">,</span>
                <span class="p">)</span> <span class="o">=</span> <span class="n">calculate_percent_thresholds</span><span class="p">(</span>
                    <span class="n">component_total</span><span class="p">,</span>
                    <span class="n">input_parameters</span><span class="p">[</span>
                        <span class="n">InputParameters</span><span class="o">.</span><span class="n">PERCENTAGE_DIFFERENCE_THRESHOLD</span><span class="o">.</span><span class="n">value</span>
                    <span class="p">],</span>
                    <span class="n">output_list</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="c1"># Absolute difference is output here as it would not change from this point</span>
                <span class="c1"># it is not output sooner as a S marker could be returned</span>
                <span class="c1"># before this point and that would have no absolute difference value.</span>
                <span class="k">if</span> <span class="n">absolute_difference_threshold</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;absolute_difference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;absolute_difference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">absolute_difference</span>

                <span class="c1"># If the received total equals the sum of the received components</span>
                <span class="c1"># then no correction needs to take place.</span>
                <span class="k">if</span> <span class="n">input_parameters</span><span class="p">[</span><span class="n">InputParameters</span><span class="o">.</span><span class="n">TOTAL</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">==</span> <span class="n">component_total</span><span class="p">:</span>
                    <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;tcc_marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TccMarker</span><span class="o">.</span><span class="n">NO_CORRECTION</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1">#  Determine if the difference error can be automatically corrected</span>
                    <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;tcc_marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">determine_error_detection</span><span class="p">(</span>
                        <span class="n">input_parameters</span><span class="p">[</span>
                            <span class="n">InputParameters</span><span class="o">.</span><span class="n">ABSOLUTE_DIFFERENCE_THRESHOLD</span><span class="o">.</span><span class="n">value</span>
                        <span class="p">],</span>
                        <span class="n">input_parameters</span><span class="p">[</span>
                            <span class="n">InputParameters</span><span class="o">.</span><span class="n">PERCENTAGE_DIFFERENCE_THRESHOLD</span><span class="o">.</span><span class="n">value</span>
                        <span class="p">],</span>
                        <span class="n">absolute_difference</span><span class="p">,</span>
                        <span class="n">predictive</span><span class="p">,</span>
                        <span class="n">low_threshold</span><span class="p">,</span>
                        <span class="n">high_threshold</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;tcc_marker&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">TccMarker</span><span class="o">.</span><span class="n">METHOD_PROCEED</span><span class="p">:</span>
                        <span class="p">(</span>
                            <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;final_total&quot;</span><span class="p">],</span>
                            <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;final_components&quot;</span><span class="p">],</span>
                            <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;tcc_marker&quot;</span><span class="p">],</span>
                        <span class="p">)</span> <span class="o">=</span> <span class="n">error_correction</span><span class="p">(</span>
                            <span class="n">amend_total</span><span class="o">=</span><span class="n">amend_total</span><span class="p">,</span>
                            <span class="n">components_sum</span><span class="o">=</span><span class="n">component_total</span><span class="p">,</span>
                            <span class="n">original_components</span><span class="o">=</span><span class="n">input_parameters</span><span class="p">[</span>
                                <span class="n">InputParameters</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">value</span>
                            <span class="p">],</span>
                            <span class="n">total</span><span class="o">=</span><span class="n">input_parameters</span><span class="p">[</span><span class="n">InputParameters</span><span class="o">.</span><span class="n">TOTAL</span><span class="o">.</span><span class="n">value</span><span class="p">],</span>
                        <span class="p">)</span>

        <span class="n">final_components</span> <span class="o">=</span> <span class="n">clean_component_list</span><span class="p">(</span><span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;final_components&quot;</span><span class="p">])</span>

        <span class="n">absolute_difference</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;absolute_difference&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;absolute_difference&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;absolute_difference&quot;</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="n">low_threshold</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">low_threshold</span><span class="p">)</span> <span class="k">if</span> <span class="n">low_threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">low_threshold</span>
        <span class="p">)</span>

        <span class="n">high_threshold</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">high_threshold</span><span class="p">)</span> <span class="k">if</span> <span class="n">high_threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">high_threshold</span>
        <span class="p">)</span>

        <span class="n">final_total</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;final_total&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;final_total&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;final_total&quot;</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># Return the values as raw strings instead of decimal</span>
        <span class="n">output_list</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;identifier&quot;</span><span class="p">:</span> <span class="n">identifier</span><span class="p">,</span>
            <span class="s2">&quot;absolute_difference&quot;</span><span class="p">:</span> <span class="n">absolute_difference</span><span class="p">,</span>
            <span class="s2">&quot;low_percent_threshold&quot;</span><span class="p">:</span> <span class="n">low_threshold</span><span class="p">,</span>
            <span class="s2">&quot;high_percent_threshold&quot;</span><span class="p">:</span> <span class="n">high_threshold</span><span class="p">,</span>
            <span class="s2">&quot;final_total&quot;</span><span class="p">:</span> <span class="n">final_total</span><span class="p">,</span>
            <span class="s2">&quot;final_components&quot;</span><span class="p">:</span> <span class="n">final_components</span><span class="p">,</span>
            <span class="s2">&quot;tcc_marker&quot;</span><span class="p">:</span> <span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;tcc_marker&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">output</span> <span class="o">=</span> <span class="n">TotalsAndComponentsOutput</span><span class="p">(</span><span class="n">output_list</span><span class="p">)</span>

        <span class="c1"># Log the output table with the final values</span>
        <span class="n">log_table</span><span class="p">(</span>
            <span class="s2">&quot;Totals and Components Output&quot;</span><span class="p">,</span>
            <span class="n">identifier</span><span class="o">=</span><span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">],</span>
            <span class="n">absolute_difference</span><span class="o">=</span><span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;absolute_difference&quot;</span><span class="p">],</span>
            <span class="n">low_percent_threshold</span><span class="o">=</span><span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;low_percent_threshold&quot;</span><span class="p">],</span>
            <span class="n">high_percent_threshold</span><span class="o">=</span><span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;high_percent_threshold&quot;</span><span class="p">],</span>
            <span class="n">final_total</span><span class="o">=</span><span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;final_total&quot;</span><span class="p">],</span>
            <span class="n">final_components</span><span class="o">=</span><span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;final_components&quot;</span><span class="p">],</span>
            <span class="n">tcc_marker</span><span class="o">=</span><span class="n">output_list</span><span class="p">[</span><span class="s2">&quot;tcc_marker&quot;</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">identifier</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">identifier</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;identifier: </span><span class="si">{</span><span class="n">identifier</span><span class="si">}</span><span class="s2">, Exception full traceback: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">TACException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;identifier: </span><span class="si">{</span><span class="n">identifier</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="sml_small.editing.totals_and_components.totals_and_components.validate_input">
<code class="highlight language-python"><span class="n">validate_input</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">amend_total</span><span class="p">,</span> <span class="n">predictive</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="n">auxiliary</span><span class="p">,</span> <span class="n">absolute_difference_threshold</span><span class="p">,</span> <span class="n">percentage_difference_threshold</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This function is used to validate the data passed to the totals_and_components
method ensuring that the values are present when expected and that they are of
the correct type. If invalid data is received then an appropriate exception is
raised.</p>
<p>:param identifier: Unique identifier for the calculation.
:type identifier: str
:param total: Target total, numeric  nulls allowed
:type total: float
:param components: Corresponding list of Total variable's components, numeric  nulls allowed
:type components: List[ComponentPair]
:param amend_total: amend total is used for error correction
:type amend_total: bool
:param predictive: A value used as a predictor for a contributor's target variable.
:type predictive: Optional[float]
:param precision: Precision is used by the decimal package to perform calculations to the specified accuracy.
:type precision: int
:param auxiliary: The variable used as a predictor for a contributors target variable,
                  where the predictive value is not available.
:type auxiliary: Optional[float]
:param absolute_difference_threshold: Is the predefined threshold for the absolute difference
:type absolute_difference_threshold: Optional[float]
:param percentage_difference_threshold: Is the predefined percentage threshold
                                        represented as a decimal
:type percentage_difference_threshold: Optional[float]
...
:raises ValueError: ValueErrors are returned when required data is missing or in the
                    incorrect type/format.
...
:return: precision
:rtype: int</p>

      <details class="quote">
        <summary>Source code in <code>sml_small/editing/totals_and_components/totals_and_components.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">validate_input</span><span class="p">(</span>
    <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">total</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">components</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ComponentPair</span><span class="p">],</span>
    <span class="n">amend_total</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">predictive</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">precision</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">auxiliary</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">absolute_difference_threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">percentage_difference_threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is used to validate the data passed to the totals_and_components</span>
<span class="sd">    method ensuring that the values are present when expected and that they are of</span>
<span class="sd">    the correct type. If invalid data is received then an appropriate exception is</span>
<span class="sd">    raised.</span>

<span class="sd">    :param identifier: Unique identifier for the calculation.</span>
<span class="sd">    :type identifier: str</span>
<span class="sd">    :param total: Target total, numeric  nulls allowed</span>
<span class="sd">    :type total: float</span>
<span class="sd">    :param components: Corresponding list of Total variable&#39;s components, numeric  nulls allowed</span>
<span class="sd">    :type components: List[ComponentPair]</span>
<span class="sd">    :param amend_total: amend total is used for error correction</span>
<span class="sd">    :type amend_total: bool</span>
<span class="sd">    :param predictive: A value used as a predictor for a contributor&#39;s target variable.</span>
<span class="sd">    :type predictive: Optional[float]</span>
<span class="sd">    :param precision: Precision is used by the decimal package to perform calculations to the specified accuracy.</span>
<span class="sd">    :type precision: int</span>
<span class="sd">    :param auxiliary: The variable used as a predictor for a contributors target variable,</span>
<span class="sd">                      where the predictive value is not available.</span>
<span class="sd">    :type auxiliary: Optional[float]</span>
<span class="sd">    :param absolute_difference_threshold: Is the predefined threshold for the absolute difference</span>
<span class="sd">    :type absolute_difference_threshold: Optional[float]</span>
<span class="sd">    :param percentage_difference_threshold: Is the predefined percentage threshold</span>
<span class="sd">                                            represented as a decimal</span>
<span class="sd">    :type percentage_difference_threshold: Optional[float]</span>
<span class="sd">    ...</span>
<span class="sd">    :raises ValueError: ValueErrors are returned when required data is missing or in the</span>
<span class="sd">                        incorrect type/format.</span>
<span class="sd">    ...</span>
<span class="sd">    :return: precision</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">identifier</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">get_mandatory_param_error</span><span class="p">(</span><span class="s2">&quot;identifier&quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">total</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">get_mandatory_param_error</span><span class="p">(</span><span class="s2">&quot;total&quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">validate_number</span><span class="p">(</span><span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>

    <span class="c1"># A list of empty components is not considered an error condition,</span>
    <span class="c1"># absence of any component list is an error</span>
    <span class="k">if</span> <span class="n">components</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">get_mandatory_param_error</span><span class="p">(</span><span class="s2">&quot;components&quot;</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">validate_number</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;component=</span><span class="si">{</span><span class="n">component</span><span class="o">.</span><span class="n">original_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">component</span><span class="o">.</span><span class="n">original_value</span>
        <span class="p">):</span>
            <span class="n">component</span><span class="o">.</span><span class="n">original_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">original_value</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">amend_total</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">get_mandatory_param_error</span><span class="p">(</span><span class="s2">&quot;amend_total&quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">predictive</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">validate_number</span><span class="p">(</span><span class="s2">&quot;predictive&quot;</span><span class="p">,</span> <span class="n">predictive</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">predictive</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">predictive</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">auxiliary</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">validate_number</span><span class="p">(</span><span class="s2">&quot;auxiliary&quot;</span><span class="p">,</span> <span class="n">auxiliary</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">auxiliary</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">auxiliary</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">absolute_difference_threshold</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="n">percentage_difference_threshold</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="n">get_one_of_params_mandatory_error</span><span class="p">(</span>
                <span class="p">[</span><span class="s2">&quot;absolute_difference_threshold&quot;</span><span class="p">,</span> <span class="s2">&quot;percentage_difference_threshold&quot;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">absolute_difference_threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="n">validate_number</span><span class="p">(</span>
            <span class="s2">&quot;absolute difference threshold&quot;</span><span class="p">,</span> <span class="n">absolute_difference_threshold</span>
        <span class="p">)</span>
        <span class="ow">is</span> <span class="kc">True</span>
    <span class="p">):</span>
        <span class="n">absolute_difference_threshold</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">absolute_difference_threshold</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">percentage_difference_threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="n">validate_number</span><span class="p">(</span>
            <span class="s2">&quot;percentage difference threshold&quot;</span><span class="p">,</span> <span class="n">percentage_difference_threshold</span>
        <span class="p">)</span>
        <span class="ow">is</span> <span class="kc">True</span>
    <span class="p">):</span>
        <span class="n">percentage_difference_threshold</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">percentage_difference_threshold</span><span class="p">)</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="n">validate_precision</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">precision</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div></p>
    </article>
</section>
        
            <!--

-->

<li >
    <a href="..">Home</a>
</li>

          
            <!--

-->

<li >
    <a href="../content/">Content</a>
</li>

          
                                    </main>
                                </div>
                            </div>
                        </div>
                    

                    
                </div>
                
                
                    
                        

    
    

    
        
    

    

    <footer class="ons-footer">

        

        

        <div class="ons-footer__body ons-page__footer" data-analytics="footer" >
            <div class="ons-container">
                <div class="ons-grid">
                    

                    

                    
                </div>

                <div class="ons-grid ons-grid--flex ons-grid--vertical-top ons-grid--between">
                    <div class="ons-grid__col">
                        

                        
                            <!-- OGL -->
                            <div class="ons-footer__license ons-u-mb-m">
                                

    

    
    
        <svg class="ons-footer__ogl-img" xmlns="http://www.w3.org/2000/svg" width="50px" height="20px" viewBox="0 0 60 24" focusable="false" aria-hidden="true">
            <title>Open Government License logo</title>
            <path d="M51.7,17.5V0l-6.2,4v19.8h13.8v-6.2H51.7z M36.7,16.3c-1,0.9-2.4,1.4-3.8,1.4c-3.2,0-5.8-2.6-5.8-5.8s2.6-5.8,5.8-5.8c2,0,3.9,1.1,4.9,2.7L43,5.6C40.9,2.2,37.1,0,32.9,0c-4.5,0-8.4,2.5-10.4,6.1C20.4,2.5,16.5,0,12,0C5.4,0,0,5.4,0,12s5.4,12,12,12c4.5,0,8.4-2.5,10.4-6.1c2.1,3.6,6,6.1,10.4,6.1c3,0,5.8-1.1,7.9-3l2.4,2.7h0.4V13h-9.8L36.7,16.3zM12,17.8c-3.2,0-5.8-2.6-5.8-5.8S8.8,6.2,12,6.2s5.8,2.6,5.8,5.8S15.2,17.8,12,17.8" fill="#595959"></path>
        </svg>
    
    

                                
                                    
                                    
                                        All content is available under the 
    <a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" class="ons-external-link" target="_blank" rel="noopener">
        <span class="ons-external-link__text">Open Government Licence v3.0</span><span class="ons-external-link__icon">&nbsp;<svg class="ons-svg-icon" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg" focusable="false" aria-hidden="true">
        <path d="M13.5,9H13a.5.5,0,0,0-.5.5v3h-9v-9h3A.5.5,0,0,0,7,3V2.5A.5.5,0,0,0,6.5,2h-4a.5.5,0,0,0-.5.5v11a.5.5,0,0,0,.5.5h11a.5.5,0,0,0,.5-.5v-4A.5.5,0,0,0,13.5,9Z" transform="translate(-2 -1.99)"/>
        <path d="M8.83,7.88a.51.51,0,0,0,.71,0l2.31-2.32,1.28,1.28A.51.51,0,0,0,14,6.49v-4a.52.52,0,0,0-.5-.5h-4A.51.51,0,0,0,9,2.52a.58.58,0,0,0,.14.33l1.28,1.28L8.12,6.46a.51.51,0,0,0,0,.71Z" transform="translate(-2 -1.99)"/>
    </svg></span><span class="ons-external-link__new-window-description ons-u-vh"> (opens in a new tab)</span></a>
, except where otherwise stated
                                    
                                
                            </div>
                        
                        
                            <div class="ons-footer__poweredby ons-u-mb-m">
                                
        
            

    

    
    
        <svg class="ons-svg-logo" xmlns="http://www.w3.org/2000/svg" width="197" height="19" viewBox="33 2 552 60" aria-labelledby="ons-logo-en-footer-alt">
            <title id="ons-logo-en-footer-alt">Office for National Statistics</title>
            <g class="ons-svg-logo__group ons-svg-logo__group--secondary" fill="#a8bd3a">
                <path d="M0,34.6c.8-1.69,1.39-3,2.32-4.6A38.28,38.28,0,0,1,0,23.4V34.6M5,3S0,3,0,9.25v1A62.12,62.12,0,0,0,4.2,27a43.77,43.77,0,0,1,9.42-10.79C21.69,9.21,31.16,5.13,45.9,3Z"/>
            </g>
            <g class="ons-svg-logo__group ons-svg-logo__group--primary" fill="#003c57">
                <path d="M53.06,6.42C36.2,8,24.68,12.92,16.43,20.07A41.46,41.46,0,0,0,6.4,32.2C12.87,44.93,28.88,57,46.6,57H47s6.32.21,6.32-6.91V6.36a1.22,1.22,0,0,1-.26.06M9.72,42.67a44.25,44.25,0,0,1-5-7.42A80.59,80.59,0,0,0,0,46.38V56.91L31.06,57c-9.83-3-15.74-7.64-21.34-14.3"/>
            </g>
            <g class="ons-svg-logo__group ons-svg-logo__group--text" fill="#003c57">
                <path d="M82,47.49c-9.07,0-13.13-7.51-13.13-16.77S72.91,14,82,14s13.1,7.61,13.1,16.77S91.1,47.54,82,47.54m0-30.91c-6.69,0-9.07,7.33-9.07,14.05s2.16,13.9,9.07,13.9,9-7.28,9-13.9-2.34-14-9-14"/>
                <path d="M106.36,23.81V46.88h-3.67V23.81H98.93V21.56h3.76V17.9c0-4.61,2.72-7.95,8.08-7.95.38,0,.86.05.86.05v2.35h-.43c-2.55,0-4.84,1.64-4.84,5.12v4.09h5.27v2.25Z"/>
                <path d="M121.53,23.81V46.88h-3.67V23.81H114.1V21.56h3.76V17.9c0-4.61,2.72-7.95,8.08-7.95.38,0,.86.05.86.05v2.35h-.43c-2.55,0-4.84,1.64-4.84,5.12v4.09h5.27v2.25Z"/>
                <path d="M132.85,16.72a2.28,2.28,0,0,1-2.33-2.23v0a2.34,2.34,0,0,1,4.67,0,2.28,2.28,0,0,1-2.3,2.26h0M131,21.56h3.71V46.88H131Z"/>
                <path d="M150.53,47.49c-6,0-10.63-5.16-10.63-13.29S144.52,21,150.66,21a9.76,9.76,0,0,1,6.17,1.74l-1,2.25a7.53,7.53,0,0,0-4.4-1.36c-5.15,0-7.78,4.46-7.78,10.48,0,6.2,3,10.62,7.65,10.62a8,8,0,0,0,4.49-1.37l1,2.45a10.21,10.21,0,0,1-6.3,1.73"/>
                <path d="M162.84,35.75c.48,6,3.76,9,8.9,9a14.66,14.66,0,0,0,6.88-1.55l1.08,2.59a18,18,0,0,1-8.22,1.73c-7.12,0-12.18-4.23-12.18-13.34,0-8.69,4.67-13.2,11-13.2s10.37,3.95,10.37,12.4Zm7.35-12.41c-4.1,0-7.56,3.2-7.52,10.29l14.39-2c0-5.87-2.81-8.32-6.87-8.32"/>
                <path d="M198.57,23.81V46.88H194.9V23.81h-3.76V21.56h3.76V17.9c0-4.61,2.72-7.95,8.08-7.95.39,0,.87.05.87.05v2.35h-.44c-2.54,0-4.84,1.64-4.84,5.12v4.09h5.28v2.25Z"/>
                <path d="M217.28,47.49c-7.47,0-10.89-5.78-10.89-13.24S209.81,21,217.28,21s10.85,5.82,10.85,13.3-3.37,13.24-10.85,13.24m0-24c-5.53,0-7.13,5.59-7.13,10.81s1.73,10.56,7.13,10.56,7.13-5.35,7.13-10.56-1.6-10.81-7.13-10.81"/>
                <path d="M244.08,23.91c-2.34-.61-5.75-.52-7.35.47v22.5H233V22.69c2.67-1.13,5.36-1.74,10.11-1.74H245Z"/>
                <path d="M277.42,47.13,263.07,25a32.2,32.2,0,0,1-1.85-3.29h-.09s.13,1.88.13,3.85V47.13h-4.71V14.8h5.31l13.61,20.82A28.76,28.76,0,0,1,277.38,39h.08s-.17-1.84-.17-3.77V14.8H282V47.13Z"/>
                <path d="M297.52,47.79c-7.43,0-10.93-3-10.93-7.81,0-6.8,7.12-8.64,15.59-9.39V29.13c0-3.47-2.37-4.51-5.83-4.51a18,18,0,0,0-6.87,1.46L288.23,23a24,24,0,0,1,9.12-1.83c5.61,0,9.93,2.3,9.93,8.78V46a22.71,22.71,0,0,1-9.76,1.83m4.66-14.67c-6.26.67-10.45,1.84-10.45,6.73,0,3.42,2.42,4.88,6.22,4.88a10.09,10.09,0,0,0,4.23-.84Z"/>
                <path d="M322,47.69c-5.31,0-7.34-3.43-7.34-6.86V25.09h-3.55V21.81h3.55V16.12l5.4-1.5v7.19H325v3.28h-5V40.55a3.26,3.26,0,0,0,3,3.52h.5a5.5,5.5,0,0,0,1.46-.23v3.33a7.69,7.69,0,0,1-3,.52"/>
                <path d="M331.91,17.43a3,3,0,0,1-3.15-2.81,3.17,3.17,0,0,1,6.31,0,3,3,0,0,1-3.16,2.81m-2.72,4.38h5.44V47.13h-5.44Z"/>
                <path d="M350.88,47.79c-7.73,0-11.57-5.74-11.57-13.3s3.84-13.34,11.57-13.34,11.54,5.78,11.54,13.34-3.8,13.3-11.54,13.3m0-23.17c-4.66,0-6.05,4.89-6.05,9.82s1.47,9.63,6.05,9.63,6.05-4.7,6.05-9.63-1.38-9.82-6.05-9.82"/>
                <path d="M382.52,47.13V29c0-3.24-2.77-4.47-5.88-4.47a12.3,12.3,0,0,0-4.37.76v21.8h-5.39V23a26.81,26.81,0,0,1,10.06-1.83c6.61,0,11,2.25,11,7.8V47.13Z"/>
                <path d="M403.18,47.79c-7.43,0-10.94-3-10.94-7.81,0-6.8,7.13-8.64,15.6-9.39V29.13c0-3.47-2.37-4.51-5.83-4.51a18,18,0,0,0-6.87,1.46L393.89,23A24,24,0,0,1,403,21.15c5.62,0,9.94,2.3,9.94,8.78V46a22.71,22.71,0,0,1-9.76,1.83m4.66-14.67c-6.27.67-10.46,1.84-10.46,6.73,0,3.42,2.43,4.88,6.23,4.88a10.09,10.09,0,0,0,4.23-.84Z"/>
                <polygon points="418.52 47.13 418.52 34.91 418.52 10.25 423.92 10.25 423.92 22.76 423.92 47.13 418.52 47.13"/>
                <path d="M445.39,47.79A19.11,19.11,0,0,1,436.58,46l1.51-4a13.48,13.48,0,0,0,6.22,1.55c3.76,0,6.44-2.21,6.44-5.41,0-7.09-13.44-4.36-13.44-14.42,0-5.13,4.15-9.59,10.72-9.59A15.82,15.82,0,0,1,455.8,16l-1.38,3.52a11.93,11.93,0,0,0-5.66-1.5c-3.5,0-5.79,2.11-5.79,5.12,0,7,13.74,3.94,13.74,14.65,0,5.74-4.71,10-11.32,10"/>
                <path d="M470.41,47.69c-5.31,0-7.34-3.43-7.34-6.86V25.09h-3.54V21.81h3.54V16.12l5.4-1.5v7.19h4.92v3.28h-4.92V40.55a3.27,3.27,0,0,0,3,3.52h.48a5.12,5.12,0,0,0,1.46-.23v3.33a7.69,7.69,0,0,1-3,.52"/>
                <path d="M487.27,47.79c-7.44,0-10.93-3-10.93-7.81,0-6.8,7.13-8.64,15.6-9.39V29.13c0-3.47-2.38-4.51-5.84-4.51a18,18,0,0,0-6.87,1.46L478,23a23.94,23.94,0,0,1,9.11-1.83c5.62,0,9.94,2.3,9.94,8.78V46a22.71,22.71,0,0,1-9.76,1.83M492,33.16c-6.27.67-10.46,1.84-10.46,6.73,0,3.42,2.42,4.88,6.22,4.88a10,10,0,0,0,4.24-.84Z"/>
                <path d="M511.73,47.69c-5.32,0-7.35-3.43-7.35-6.86V25.09h-3.54V21.81h3.54V16.12l5.4-1.5v7.19h4.92v3.28h-4.92V40.55a3.26,3.26,0,0,0,3,3.52h.5a5.5,5.5,0,0,0,1.46-.23v3.33a7.69,7.69,0,0,1-3,.52"/>
                <path d="M521.66,17.43a3,3,0,0,1-3.15-2.81,3.17,3.17,0,0,1,6.31,0,3,3,0,0,1-3.16,2.81m-2.72,4.38h5.45V47.13h-5.45Z"/>
                <path d="M536.19,47.79A15.9,15.9,0,0,1,528.54,46L530,42.48a10.53,10.53,0,0,0,5.52,1.5c2.77,0,5-1.78,5-3.94,0-6-11.1-3.2-11.1-11.47,0-3.76,3.37-7.42,8.86-7.42A13.56,13.56,0,0,1,545.34,23l-1.42,3.14a8.47,8.47,0,0,0-4.62-1.45c-2.81,0-4.54,1.69-4.54,3.62,0,5.64,11.32,3.14,11.32,11.6,0,4-3.85,7.9-9.89,7.9"/>
                <path d="M559.83,47.69c-5.31,0-7.35-3.43-7.35-6.86V25.09h-3.54V21.81h3.54V16.12l5.4-1.5v7.19h4.93v3.28h-4.93V40.55a3.27,3.27,0,0,0,3,3.52h.48a5.64,5.64,0,0,0,1.47-.23v3.33a7.72,7.72,0,0,1-3,.52"/>
                <path d="M569.77,17.43a3,3,0,0,1-3.15-2.81,3.17,3.17,0,0,1,6.31,0,3,3,0,0,1-3.16,2.81m-2.72,4.38h5.44V47.13h-5.44Z"/>
                <path d="M588.14,47.79c-6.23,0-11-5.08-11-13.35s4.88-13.29,11-13.29A10.51,10.51,0,0,1,594.66,23l-1.21,3a6.87,6.87,0,0,0-4-1.22c-4.4,0-6.69,3.81-6.69,9.49s2.63,9.59,6.61,9.59a6.74,6.74,0,0,0,4-1.28L594.7,46c-1.12.94-3.33,1.84-6.56,1.84"/>
                <path d="M605.1,47.79A15.9,15.9,0,0,1,597.45,46l1.42-3.47A10.54,10.54,0,0,0,604.4,44c2.77,0,5-1.78,5-3.94,0-6-11.1-3.2-11.1-11.47,0-3.76,3.37-7.42,8.85-7.42a13.49,13.49,0,0,1,7.1,1.83l-1.42,3.14a8.42,8.42,0,0,0-4.63-1.45c-2.8,0-4.53,1.69-4.53,3.62,0,5.64,11.32,3.14,11.32,11.6,0,4-3.85,7.9-9.89,7.9"/>
            </g>
        </svg>
    

        
    
                            </div>
                        
                    </div>
                    
                </div>
                
                
            </div>
        </div>
    </footer>


                    
                
            </div>
            
        

        
            
        

        <script>
            (function() {
                var s = 'https://cdn.ons.gov.uk/sdc/design-system/62.0.0/scripts/main.js'.split(','),
                c = document.createElement('script');

                if (!('noModule' in c)) {
                    for (var i = 0; i < s.length; i++) {
                        s[i] = s[i].replace('.js', '.es5.js');
                    }
                }

                for (var i = 0; i < s.length; i++) {
                    var e = document.createElement('script');

                    e.src = s[i];

                    document.body.appendChild(e);
                }
            })();
        </script>

        
    </body>
</html>